<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Navigation Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Playfair+Display:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            margin: 0;
            background-color: #030303;
            color: white;
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
        }
        .tab-button {
            transition: all 0.6s cubic-bezier(0.25, 0.4, 0.25, 1);
        }
        .tab-text {
            transition: all 0.8s cubic-bezier(0.25, 0.4, 0.25, 1);
            max-width: 0;
            opacity: 0;
            overflow: hidden;
            white-space: nowrap;
        }
        .tab-text.expanded {
            max-width: 200px;
            opacity: 1;
            margin-left: 0.5rem;
        }
        .tab-button.selected {
            padding-left: 1rem;
            padding-right: 1rem;
        }
        .tab-button:not(.selected) {
            padding-left: 0.75rem;
            padding-right: 0.75rem;
        }
        .separator {
            width: 1px;
            height: 20px;
            margin: 0 0.5rem;
        }
        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-10px); }
            to   { opacity: 1; transform: translateY(0); }
        }
        .anim-hidden-initial {
            opacity: 0;
        }
        .content-section {
            display: none;
            animation: fadeIn 0.3s ease-in-out;
        }
        .content-section.active {
            display: block;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .form-container {
            max-width: none;
            margin: 0;
            padding: 1rem;
        }
        .form-item {
            margin-bottom: 1rem;
        }
        .form-label {
            display: block;
            font-size: 0.875rem;
            font-weight: 500;
            margin-bottom: 0.5rem;
            color: white;
            font-family: 'Inter', sans-serif;
            letter-spacing: 0.025em;
        }
        .form-input {
            width: 100%;
            height: 2.25rem;
            padding: 0.5rem 0.75rem;
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 0.5rem;
            background-color: rgba(255, 255, 255, 0.05);
            color: white;
            font-size: 0.875rem;
            transition: all 0.2s ease-in-out;
            box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
        }
        .form-input:focus {
            outline: none;
            border-color: rgb(59, 130, 246);
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }
        .form-input::placeholder {
            color: rgba(255, 255, 255, 0.4);
        }
        .form-button {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: 0.5rem 1rem;
            border: none;
            border-radius: 0.5rem;
            background-color: rgb(59, 130, 246);
            color: white;
            font-size: 0.875rem;
            font-weight: 500;
            cursor: pointer;
            transition: background-color 0.2s ease-in-out;
            box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
            font-family: 'Inter', sans-serif;
            letter-spacing: 0.025em;
        }
        .form-button:hover {
            background-color: rgb(37, 99, 235);
        }
        .section-title {
            font-family: 'Playfair Display', serif;
            font-size: 2rem;
            font-weight: 600;
            margin-bottom: 1.5rem;
            color: white;
            letter-spacing: -0.025em;
        }
        .section-content {
            color: rgba(255, 255, 255, 0.8);
            line-height: 1.6;
        }
        .form-row {
            display: flex;
            gap: 1rem;
        }
        .form-row .form-item {
            flex: 1;
        }
        @media (max-width: 768px) {
            .form-row {
                flex-direction: column;
                gap: 0;
            }
        }
        
        /* Calendar icon for date input */
        input[type="date"] {
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></svg>');
            background-repeat: no-repeat;
            background-position: right 0.75rem center;
            background-size: 1rem;
        }
        
        /* Remove button styling and animation */
        .remove-section {
            transition: all 0.3s ease;
            color: white !important;
        }
        .remove-section:hover {
            color: white !important;
            transform: rotate(90deg);
        }
        
        /* Modal styles */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: transparent;
            backdrop-filter: blur(5px);
        }
        
        .modal.show {
            display: flex;
            align-items: center;
            justify-content: center;
            animation: fadeIn 0.3s ease-out;
        }
        
        .modal-content {
            background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 2rem;
            max-width: 500px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.3);
            animation: slideIn 0.3s ease-out;
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .modal-title {
            font-family: 'Playfair Display', serif;
            font-size: 1.5rem;
            font-weight: 600;
            color: white;
            margin: 0;
        }
        
        .modal-close {
            background: none;
            border: none;
            color: rgba(255, 255, 255, 0.6);
            cursor: pointer;
            padding: 0.5rem;
            border-radius: 0.5rem;
            transition: all 0.2s ease;
        }
        
        .modal-close:hover {
            color: white;
            background-color: rgba(255, 255, 255, 0.1);
        }
        
        .modal-body {
            color: rgba(255, 255, 255, 0.8);
            line-height: 1.6;
            margin-bottom: 1.5rem;
        }
        
        .modal-url-link {
            color: #60a5fa;
            text-decoration: underline;
            word-break: break-all;
            word-wrap: break-word;
            overflow-wrap: break-word;
            hyphens: auto;
            transition: color 0.2s ease;
        }
        
        .modal-url-link:hover {
            color: #93c5fd;
            text-decoration: none;
        }
        
        .modal-body p {
            word-break: break-word;
            overflow-wrap: break-word;
        }
        
        .modal-button {
            padding: 0.5rem 1rem;
            border: none;
            border-radius: 0.5rem;
            font-size: 0.875rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            font-family: 'Inter', sans-serif;
        }
        
        .modal-button-primary {
            background-color: rgb(59, 130, 246);
            color: white;
        }
        
        .modal-button-primary:hover {
            background-color: rgb(37, 99, 235);
        }
        
        .modal-button-secondary {
            background-color: rgba(255, 255, 255, 0.1);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .modal-button-secondary:hover {
            background-color: rgba(255, 255, 255, 0.2);
        }
        
        .error-modal .modal-title {
            color: #ef4444;
        }
        
        .success-modal .modal-title {
            color: #10b981;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-20px) scale(0.95);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }
        
        /* Line clamp utility for text truncation */
        .line-clamp-2 {
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }
        
        /* Blog list item hover effects */
        .blog-item {
            transition: all 0.2s ease-in-out;
        }
        
        .blog-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }
        
        /* Pagination button styles */
        .pagination-btn {
            transition: all 0.2s ease-in-out;
        }
        
        .pagination-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }
        
        .pagination-btn:not(:disabled):hover {
            transform: translateY(-1px);
        }
        
        /* Search input focus enhancement */
        .search-input:focus {
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
            border-color: rgb(59, 130, 246);
        }
        
        /* Status badge styles */
        .status-badge {
            font-size: 0.75rem;
            padding: 0.25rem 0.5rem;
            border-radius: 9999px;
            font-weight: 500;
        }
        
        .status-published {
            background-color: rgba(34, 197, 94, 0.2);
            color: rgb(74, 222, 128);
        }
        
        .status-draft {
            background-color: rgba(234, 179, 8, 0.2);
            color: rgb(250, 204, 21);
        }
        
        /* Grid Layout Styles */
        .main-grid-container {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            grid-template-rows: repeat(5, 1fr);
            gap: 16px;
            min-height: calc(100vh - 120px);
            max-width: 1400px;
            margin: 0 auto;
        }
        
        .left-section {
            grid-column: span 3 / span 3;
            grid-row: span 5 / span 5;
            background: rgba(255, 255, 255, 0.02);
            border: 1px solid rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 1.5rem;
            overflow-y: auto;
            overflow-x: hidden;
            max-height: calc(100vh - 140px);
            scrollbar-width: none;
            -ms-overflow-style: none;
        }
        
        .left-section::-webkit-scrollbar {
            display: none;
        }
        
        .right-section {
            grid-column: span 2 / span 2;
            grid-row: span 5 / span 5;
            grid-column-start: 4;
            background: rgba(255, 255, 255, 0.02);
            border: 1px solid rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 1.5rem;
            overflow-y: auto;
            overflow-x: hidden;
            max-height: calc(100vh - 140px);
            scrollbar-width: none;
            -ms-overflow-style: none;
        }
        
        .right-section::-webkit-scrollbar {
            display: none;
        }
        
        .left-section-header {
            backdrop-filter: blur(35px);
            -webkit-backdrop-filter: blur(35px);
            /* background: rgba(255, 255, 255, 0.02);
            border: 1px solid rgba(255, 255, 255, 0.05); */
            border-radius: 70px;
            padding: 12px 20px;
            margin-bottom: 2rem;
        }
        
        .left-section-tabs {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }
        
        .left-tab-button {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 1.25rem 2rem;
            border-radius: 12px;
            color: rgba(255, 255, 255, 0.5);
            text-decoration: none;
            transition: all 0.3s ease;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 500;
        }
        
        .left-tab-button:hover {
            background: rgba(255, 255, 255, 0.05);
            color: rgba(255, 255, 255, 0.9);
            transform: translateY(-2px);
        }
        
        .left-tab-button.active {
            /* background: rgba(59, 130, 246, 0.2); */
            color: rgba(255, 255, 255, 0.9);;
        }
        
        .left-content-section {
            display: none;
            margin-top: 1.5rem;
        }
        
        .left-content-section.active {
            display: block;
        }
        
        /* Responsive adjustments */
        @media (max-width: 1200px) {
            .main-grid-container {
                grid-template-columns: 1fr;
                grid-template-rows: auto auto;
                gap: 1rem;
            }
            
            .left-section {
                grid-column: 1;
                grid-row: 1;
            }
            
            .right-section {
                grid-column: 1;
                grid-row: 2;
                grid-column-start: auto;
            }
            
            .left-section-tabs {
                flex-direction: row;
                flex-wrap: wrap;
            }
        }
        
        @media (max-width: 768px) {
            .main-grid-container {
                padding: 0 1rem;
            }
            
            .left-section, .right-section {
                padding: 1rem;
            }
        }
        
        /* Upload and Gallery Styles from manage_files.html */
        .dropzone {
            border: 2px dashed rgba(255, 255, 255, 0.2);
            border-radius: 20px;
            padding: 2.5rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s ease;
            background-color: rgba(255, 255, 255, 0.02);
        }
        .dropzone.dragover {
            border-color: rgb(59, 130, 246);
            background-color: rgba(59, 130, 246, 0.1);
        }
        .dropzone i,
        .dropzone p {
            transition: opacity 0.2s ease-in-out;
        }
        .file-queue-item {
            display: flex;
            align-items: center;
            padding: 0.75rem 1rem;
            border-radius: 20px;
            background-color: rgba(255, 255, 255, 0.05);
        }
        .gallery-item {
            position: relative;
            overflow: hidden;
            border-radius: 20px;
            transition: all 0.2s ease;
            background-color: rgba(255, 255, 255, 0.03);
        }
        .gallery-item:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.2);
        }
        .gallery-item .overlay {
            position: absolute;
            inset: 0;
            background: linear-gradient(to top, rgba(0,0,0,0.8), transparent 50%);
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        .gallery-item:hover .overlay {
            opacity: 1;
        }
        .gallery-item .actions {
            position: absolute;
            top: 0.75rem;
            right: 0.75rem;
            display: flex;
            gap: 0.5rem;
            opacity: 0;
            transform: translateY(-10px);
            transition: all 0.3s ease;
            z-index: 10;
            pointer-events: auto;
        }
        .gallery-item:hover .actions {
            opacity: 1;
            transform: translateY(0);
        }
        .gallery-item .actions button {
            border-radius: 9999px;
            padding: 0.5rem;
            background-color: rgba(0,0,0,0.5);
            transition: background-color 0.2s;
        }
        .gallery-item .actions button:hover {
             background-color: black;
        }
        .search-input-container {
            position: relative;
        }
        .search-input-container::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            width: 0;
            height: 1px;
            background-color: rgba(255, 255, 255, 0.6);
            transform: translateX(-50%);
            transition: width 0.3s ease-in-out;
        }
        .search-input-container:hover::after {
            width: 100%;
        }
        .search-input-container.focused::after {
            width: 100%;
        }
        .search-input {
            background-color: transparent;
            border: none;
            color: white;
            transition: all 0.3s ease-in-out;
        }
        .search-input:focus {
            outline: none;
        }
        .search-input::placeholder {
            color: rgba(255, 255, 255, 0.5);
        }
        
        /* Storage sub-tabs styles */
        .storage-sub-tab {
            transition: all 0.2s ease;
        }
        
        .storage-sub-tab:hover {
            background: rgba(255, 255, 255, 0.15) !important;
            color: rgba(255, 255, 255, 0.9) !important;
        }
        
        .storage-sub-tab.active {
            background: rgba(59, 130, 246, 0.2) !important;
            color: white !important;
            border-color: rgba(59, 130, 246, 0.4) !important;
        }
        
        .storage-sub-content {
            display: none;
        }
        
        .storage-sub-content.active {
            display: block;
        }
        
        /* Text formatting toolbar styles */
        .text-formatting-toolbar {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 0.5rem;
            padding: 0.5rem;
        }
        
        .format-btn {
            padding: 0.5rem;
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 0.375rem;
            background-color: rgba(255, 255, 255, 0.05);
            color: white;
            cursor: pointer;
            transition: all 0.2s ease-in-out;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .format-btn:hover {
            background-color: rgba(255, 255, 255, 0.15);
            border-color: rgb(59, 130, 246);
        }
        
        .format-btn.active {
            background-color: rgb(59, 130, 246);
            border-color: rgb(59, 130, 246);
        }
    </style>
</head>
<body>
    <nav class="fixed top-0 left-0 right-0 z-50">
        <div class="flex justify-center py-6">
            <div class="navbar-wrapper" style="backdrop-filter: blur(35px); -webkit-backdrop-filter: blur(35px); background: rgba(255, 255, 255, 0.02); border: 1px solid rgba(255, 255, 255, 0.05); border-radius: 70px; padding: 12px 20px;">
                <div id="navbarTabs" class="expandable-tabs flex items-center gap-4 anim-hidden-initial" style="animation: slideDown 0.8s cubic-bezier(0.25, 0.4, 0.25, 1) 0.3s forwards;">
                </div>
            </div>
        </div>
    </nav>
    <div class="fixed inset-0 bg-gradient-to-br from-indigo-500/[0.03] via-transparent to-rose-500/[0.03] pointer-events-none"></div>
    
    <!-- Main Content Sections -->
    <main class="pt-20 px-4">
        <div class="main-grid-container">
            <!-- Left Section -->
            <div class="left-section">
                <!-- Left Section Header -->
                <div class="left-section-header">
                    <div class="expandable-tabs flex items-center gap-2">
                        <button class="left-tab-button active" data-left-tab="upload-image">
                            <div class="flex-shrink-0">
                                <i data-lucide="image" class="w-4 h-4"></i>
                            </div>
                            <span>Upload Image</span>
                        </button>
                        <button class="left-tab-button" data-left-tab="storage">
                            <div class="flex-shrink-0">
                                <i data-lucide="image" class="w-4 h-4"></i>
                            </div>
                            <span>Gallery</span>
                        </button>
                    </div>
                </div>

                <!-- Left Section Content -->
                <div id="upload-imageContent" class="left-content-section active">
                    <h3 class="text-lg font-semibold mb-4 text-white" style="font-family: 'Playfair Display', serif;">Upload Images</h3>
                    <div class="bg-black/20 border-white/10 rounded-[20px] p-6">
                        <!-- Dropzone -->
                        <div id="imageDropzone" class="dropzone flex flex-col items-center justify-center space-y-3" style="border: 2px dashed rgba(255, 255, 255, 0.2); border-radius: 20px; padding: 2.5rem; text-align: center; cursor: pointer; transition: all 0.2s ease; background-color: rgba(255, 255, 255, 0.02);">
                            <i id="imageDropzoneIcon" data-lucide="upload-cloud" class="w-12 h-12 text-white/40"></i>
                            <p class="font-semibold">Drag & drop images here</p>
                            <p id="imageDropzoneText" class="text-sm text-white/60">Upload JPG, PNG, WEBP, etc. Max 10MB.</p>
                            <p class="text-xs text-white/50">or</p>
                            <button type="button" onclick="document.getElementById('imageFileInput').click()" class="form-button bg-white/10 hover:bg-white/20 text-white/90 !px-4 !py-2">Browse Files</button>
                        </div>
                        <input type="file" id="imageFileInput" multiple accept="image/*" class="hidden">
                        
                        <!-- File Queue -->
                        <div id="imageFileQueue" class="mt-6 space-y-3"></div>
                        
                        <!-- Upload Button -->
                        <div class="mt-8 flex justify-center">
                            <button id="imageUploadBtn" class="form-button bg-white text-black hover:bg-gray-100" disabled>
                                <i data-lucide="upload" class="w-4 h-4 mr-2"></i>
                                <span id="imageUploadBtnText">Upload 0 Files</span>
                            </button>
                        </div>
                    </div>
                </div>

                <div id="storageContent" class="left-content-section">
                    
                    
                    <!-- Gallery Sub-section -->
                    <div id="gallerySubContent" class="storage-sub-content active">
                        <!-- Search Bar -->
                        <div class="relative mb-6">
                            <div class="search-input-container" style="position: relative;">
                                <i data-lucide="search" class="w-4 h-4 absolute left-4 top-1/2 -translate-y-1/2 text-white/40 z-10"></i>
                                <input type="text" placeholder="Search images..." class="search-input w-full py-2 pl-11 pr-4 text-sm rounded-[20px] focus:ring-0 focus:outline-none transition bg-transparent border-none color-white" id="gallerySearchInput" style="background-color: transparent; border: none; color: white;">
                            </div>
                        </div>
                        
                        <!-- Gallery Grid -->
                        <div id="galleryGrid" class="grid grid-cols-4 gap-4">
                            <!-- Dynamic gallery items will be inserted here -->
                        </div>
                        
                        <div id="noGalleryItems" class="text-center py-8 hidden">
                            <i data-lucide="folder-x" class="w-12 h-12 mx-auto text-white/20 mb-4"></i>
                            <h4 class="text-lg font-medium text-white/80">No Images Found</h4>
                            <p class="text-white/50 mt-2">Try uploading some images or changing your search.</p>
                        </div>
                    </div>

                    <!-- Magazines Sub-section -->
                    <div id="magazinesSubContent" class="storage-sub-content">
                        <!-- Search Bar -->
                        <div class="relative mb-6">
                            <div class="search-input-container" style="position: relative;">
                                <i data-lucide="search" class="w-4 h-4 absolute left-4 top-1/2 -translate-y-1/2 text-white/40 z-10"></i>
                                <input type="text" placeholder="Search magazines..." class="search-input w-full py-2 pl-11 pr-4 text-sm rounded-[20px] focus:ring-0 focus:outline-none transition bg-transparent border-none color-white" id="magazinesSearchInput" style="background-color: transparent; border: none; color: white;">
                            </div>
                        </div>
                        
                        <!-- Magazines Grid -->
                        <div id="magazinesGrid" class="grid grid-cols-4 gap-4">
                            <!-- Dynamic magazine items will be inserted here -->
                        </div>
                        
                        <div id="noMagazineItems" class="text-center py-8 hidden">
                            <i data-lucide="folder-x" class="w-12 h-12 mx-auto text-white/20 mb-4"></i>
                            <h4 class="text-lg font-medium text-white/80">No Magazines Found</h4>
                            <p class="text-white/50 mt-2">Try uploading some magazines or changing your search.</p>
                        </div>
                    </div>
                </div>

            </div>

            <!-- Right Section -->
            <div class="right-section">
                <!-- Add Blogs Section -->
                <section id="addBlogs" class="content-section active">
                    <div class="form-container">
                        <h2 class="section-title text-center">Add New Blog</h2>
                <form id="addBlogForm">
                    
                    <!-- Category Section -->
                    <div class="category-section-wrapper p-4 rounded-lg bg-white/[0.01] border border-white/[0.03] mb-6">
                        <h3 class="text-lg font-medium text-white/90 mb-4 flex items-center">
                            <i data-lucide="tag" class="w-5 h-5 mr-2"></i>Category<span class="text-red-400">*</span>
                        </h3>
                        
                        <div class="form-row">
                            <div class="form-item">
                                <select
                                    id="blogCategory"
                                    name="blogCategory"
                                    class="form-input"
                                    style="background-color: rgba(255, 255, 255, 0.05); border: 1px solid rgba(255, 255, 255, 0.2); color: white;"
                                    required
                                >
                                    <option value="" style="background-color: #1a1a1a; color: white;">Select blog category...</option>
                                    <option value="BUSINESS" style="background-color: #1a1a1a; color: white;">BUSINESS</option>
                                    <option value="TECHNOLOGY" style="background-color: #1a1a1a; color: white;">TECHNOLOGY</option>
                                    <option value="GCC" style="background-color: #1a1a1a; color: white;">GCC</option>
                                    <option value="SUSTAINABILITY" style="background-color: #1a1a1a; color: white;">SUSTAINABILITY</option>
                                    <option value="SEMICONDUCTOR" style="background-color: #1a1a1a; color: white;">SEMICONDUCTOR</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- SEO Section -->
                    <div class="seo-section-wrapper p-4 rounded-lg bg-white/[0.01] border border-white/[0.03] mb-6">
                        <h3 class="text-lg font-medium text-white/90 mb-4 flex items-center">
                            <i data-lucide="search" class="w-5 h-5 mr-2"></i>SEO
                        </h3>
                        
                        <div class="form-item">
                            <label class="form-label" for="seoTitle">
                                <i data-lucide="type" class="w-4 h-4 inline mr-2"></i>Title
                            </label>
                            <input
                                type="text"
                                id="seoTitle"
                                name="seoTitle"
                                class="form-input"
                                placeholder="Enter SEO title..."
                            />
                        </div>

                        <div class="form-item">
                            <label class="form-label" for="seoMetaDescription">
                                <i data-lucide="file-text" class="w-4 h-4 inline mr-2"></i>Meta Description
                            </label>
                            <textarea
                                id="seoMetaDescription"
                                name="seoMetaDescription"
                                class="form-input"
                                style="height: 4rem; resize: vertical;"
                                placeholder="Enter SEO meta description..."
                            ></textarea>
                        </div>

                        <div class="form-item">
                            <label class="form-label" for="seoCanonicalUrl">
                                <i data-lucide="link" class="w-4 h-4 inline mr-2"></i>Canonical URL
                            </label>
                            <input
                                type="url"
                                id="seoCanonicalUrl"
                                name="seoCanonicalUrl"
                                class="form-input"
                                placeholder="https://brandsoutloud.com/blog/title"
                            />
                            <p class="text-xs text-white/50 mt-1">Leave empty for self-referencing canonical URL</p>
                        </div>
                    </div>

                    <!-- Content Section -->
                    <div class="content-section-wrapper p-4 rounded-lg bg-white/[0.01] border border-white/[0.03] mb-6">
                        <h3 class="text-lg font-medium text-white/90 mb-4 flex items-center">
                            <i data-lucide="layout" class="w-5 h-5 mr-2"></i>Content
                        </h3>
                        
                    <!-- Main Image URL and Alt Text -->
                    <div class="form-row">
                        <div class="form-item">
                            <label class="form-label" for="mainImageUrl">
                                <i data-lucide="image" class="w-4 h-4 inline mr-2"></i>Main Image URL <span class="text-red-400">*</span>
                            </label>
                            <input
                                type="url"
                                id="mainImageUrl"
                                name="mainImageUrl"
                                class="form-input"
                                placeholder="https://example.com/image.jpg"
                                required
                            />
                        </div>
                        <div class="form-item">
                            <label class="form-label" for="mainImageAlt">
                                <i data-lucide="type" class="w-4 h-4 inline mr-2"></i>Main Image Alt Text <span class="text-red-400">*</span>
                            </label>
                            <input
                                type="text"
                                id="mainImageAlt"
                                name="mainImageAlt"
                                class="form-input"
                                placeholder="Describe the image..."
                                required
                            />
                        </div>
                    </div>

                    <!-- Blog Title -->
                    <div class="form-item">
                        <label class="form-label" for="blogTitle">
                            <i data-lucide="heading" class="w-4 h-4 inline mr-2"></i>Blog Title <span class="text-red-400">*</span>
                        </label>
                        <input
                            type="text"
                            id="blogTitle"
                            name="blogTitle"
                            class="form-input"
                            placeholder="Enter blog title..."
                            required
                        />
                    </div>

                    <!-- Blog Author and Publish Date -->
                    <div class="form-row">
                        <div class="form-item">
                            <label class="form-label" for="blogAuthor">
                                <i data-lucide="user" class="w-4 h-4 inline mr-2"></i>Blog Author <span class="text-red-400">*</span>
                            </label>
                            <input
                                type="text"
                                id="blogAuthor"
                                name="blogAuthor"
                                class="form-input"
                                placeholder="Enter author name..."
                                required
                            />
                        </div>
                        <div class="form-item">
                            <label class="form-label" for="blogDate">
                                <i data-lucide="calendar" class="w-4 h-4 inline mr-2"></i>Blog Publish Date
                            </label>
                            <input
                                type="date"
                                id="blogDate"
                                name="blogDate"
                                class="form-input"
                            />
                        </div>
                    </div>

                    <!-- Blog Summary -->
                    <div class="form-item">
                        <label class="form-label" for="blogSummary">
                            <i data-lucide="file-text" class="w-4 h-4 inline mr-2"></i>Blog Summary <span class="text-red-400">*</span>
                        </label>
                        <textarea
                            id="blogSummary"
                            name="blogSummary"
                            class="form-input"
                            style="height: 6rem; resize: vertical;"
                            placeholder="Write a brief summary of your blog..."
                            required
                        ></textarea>
                    </div>

                    <!-- Blog Status (Only visible in edit mode) -->
                    <div class="form-item" id="blogStatusSection" style="display: none;">
                        <label class="form-label">
                            <i data-lucide="settings" class="w-4 h-4 inline mr-2"></i>Blog Status
                        </label>
                        <div class="flex gap-4">
                            <label class="flex items-center gap-2 cursor-pointer">
                                <input type="radio" name="blogStatus" value="draft" class="w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 focus:ring-blue-500">
                                <span class="text-sm text-white">Draft</span>
                            </label>
                            <label class="flex items-center gap-2 cursor-pointer">
                                <input type="radio" name="blogStatus" value="published" class="w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 focus:ring-blue-500">
                                <span class="text-sm text-white">Published</span>
                            </label>
                        </div>
                    </div>

                    <!-- Ad Banner One (Beside Leadership Spotlight) -->
                    <div class="form-item">
                        <div class="form-item">
                        <div class="flex items-center justify-between mb-2">
                        <label class="form-label text-sm flex items-center">
                            <i data-lucide="image" class="w-4 h-4 mr-2"></i>Ad Banner 
                        </label>
                        <span class="text-white/40 text-xs">W:512 X H:512</span>
                        </div>
                        <div class="space-y-2">
                            <input type="url" name="adBannerBesideUrl" class="form-input" placeholder="Image URL..." value="">
                            <input type="url" name="adBannerBesideHref" class="form-input" placeholder="Href for ad banner..." value="">
                        </div>
                    </div>
                    </div>

                    <!-- Ad Banner Two (Below Leadership Spotlight) -->
                    <div class="form-item">
                        <div class="flex items-center justify-between mb-2">
                        <label class="form-label text-sm flex items-center">
                            <i data-lucide="image" class="w-4 h-4 mr-2"></i>Ad Banner 
                        </label>
                        <span class="text-white/40 text-xs">W:1400 X H:200</span>
                        </div>
                        <div class="space-y-2">
                            <input type="url" name="adBannerBelowUrl" class="form-input" placeholder="Image URL..." value="">
                            <input type="url" name="adBannerBelowHref" class="form-input" placeholder="Href for ad banner..." value="">
                        </div>
                    </div>

                    <!-- Dynamic Content Sections -->
                    <div class="form-item">
                        <label class="form-label">
                            <i data-lucide="layers" class="w-4 h-4 inline mr-2"></i>Content Area
                        </label>
                        
                        <!-- Dynamic Sections Container - Moved to top -->
                        <div id="dynamicSections" class="space-y-4 mb-4">
                            <!-- Dynamic sections will be added here -->
                        </div>
                        
                        <!-- Content Categories -->
                        <div class="space-y-4">
                            <!-- Headers Section -->
                            <div class="p-3 rounded-lg bg-white/[0.02] border border-white/[0.05]">
                                <h4 class="text-sm font-medium text-white/80 mb-3 flex items-center">
                                    <i data-lucide="heading" class="w-4 h-4 mr-2"></i>Headers
                                </h4>
                                <div class="flex flex-wrap gap-2">
                                    <button type="button" id="addH1Btn" class="inline-flex items-center justify-center w-10 h-10 rounded-full bg-white/[0.03] border border-white/[0.08] hover:bg-white/[0.06] transition-colors" title="Add H1 Header">
                                        <i data-lucide="heading-1" class="w-4 h-4"></i>
                                    </button>
                                    <button type="button" id="addH2Btn" class="inline-flex items-center justify-center w-10 h-10 rounded-full bg-white/[0.03] border border-white/[0.08] hover:bg-white/[0.06] transition-colors" title="Add H2 Header">
                                        <i data-lucide="heading-2" class="w-4 h-4"></i>
                                    </button>
                                    <button type="button" id="addH3Btn" class="inline-flex items-center justify-center w-10 h-10 rounded-full bg-white/[0.03] border border-white/[0.08] hover:bg-white/[0.06] transition-colors" title="Add H3 Header">
                                        <i data-lucide="heading-3" class="w-4 h-4"></i>
                                    </button>
                                    <button type="button" id="addH4Btn" class="inline-flex items-center justify-center w-10 h-10 rounded-full bg-white/[0.03] border border-white/[0.08] hover:bg-white/[0.06] transition-colors" title="Add H4 Header">
                                        <i data-lucide="heading-4" class="w-4 h-4"></i>
                                    </button>
                                    <button type="button" id="addH5Btn" class="inline-flex items-center justify-center w-10 h-10 rounded-full bg-white/[0.03] border border-white/[0.08] hover:bg-white/[0.06] transition-colors" title="Add H5 Header">
                                        <i data-lucide="heading-5" class="w-4 h-4"></i>
                                    </button>
                                    <button type="button" id="addH6Btn" class="inline-flex items-center justify-center w-10 h-10 rounded-full bg-white/[0.03] border border-white/[0.08] hover:bg-white/[0.06] transition-colors" title="Add H6 Header">
                                        <i data-lucide="heading-6" class="w-4 h-4"></i>
                                    </button>
                                </div>
                            </div>

                            <!-- Others Section -->
                            <div class="p-3 rounded-lg bg-white/[0.02] border border-white/[0.05]">
                                <h4 class="text-sm font-medium text-white/80 mb-3 flex items-center">
                                    <i data-lucide="more-horizontal" class="w-4 h-4 mr-2"></i>Others
                                </h4>
                                <div class="flex flex-wrap gap-2">
                                    <button type="button" id="addTextBtn" class="inline-flex items-center gap-2 px-3 py-1 rounded-full bg-white/[0.03] border border-white/[0.08] hover:bg-white/[0.06] transition-colors" title="Add Text Content">
                                        <i data-lucide="type" class="w-4 h-4"></i>
                                        <span class="text-sm">Text</span>
                                    </button>
                                    <button type="button" id="addImageBtn" class="inline-flex items-center gap-2 px-3 py-1 rounded-full bg-white/[0.03] border border-white/[0.08] hover:bg-white/[0.06] transition-colors" title="Add Image">
                                        <i data-lucide="image" class="w-4 h-4"></i>
                                        <span class="text-sm">Image</span>
                                    </button>
                                </div>
                            </div>

                            
                        </div>
                    </div>
                    </div>
                     <!-- End Content Section -->
                    <!-- Labels Section -->
                    <div class="labels-section-wrapper p-4 rounded-lg bg-white/[0.01] border border-white/[0.03] mb-6">
                        <h3 class="text-lg font-medium text-white/90 mb-4 flex items-center">
                            <i data-lucide="tags" class="w-5 h-5 mr-2"></i>Keywords<span class="text-red-400">*</span>
                        </h3>
                        
                        <!-- Label Not Mandatory Checkbox -->
                        <div class="form-item mb-4">
                            <label class="flex items-center gap-2 cursor-pointer">
                                <input type="checkbox" id="labelsNotMandatory" class="w-4 h-4 text-blue-600 bg-gray-800 border-gray-600 rounded focus:ring-blue-500">
                                <span class="text-sm text-white/80">Keywords are not mandatory for this blog</span>
                            </label>
                        </div>
                        
                        <!-- Dynamic Labels Container -->
                        <div id="labelsContainer" class="space-y-3 mb-4">
                            <div class="label-item flex items-center gap-3">
                                <div class="flex-1">
                                    <input type="text" class="label-input form-input" placeholder="Enter Keyword..." />
                                </div>
                                <div class="w-24">
                                    <input type="number" class="weight-input form-input" placeholder="Volume" min="1" max="100" />
                                </div>
                                <button type="button" class="remove-label-btn text-white/50 hover:text-red-500 transition-colors p-2 rounded-lg hover:bg-white/[0.05]" title="Remove">
                                    <i data-lucide="x" class="w-4 h-4"></i>
                                </button>
                            </div>
                        </div>
                        
                        <button type="button" id="addLabelBtn" class="form-button bg-white/10 hover:bg-white/20 border border-white/20 text-white text-sm px-3 py-2">
                            <i data-lucide="plus" class="w-4 h-4 mr-2"></i>
                            Add Keywords
                        </button>
                    </div>

                    <!-- Action Buttons -->
                    <div class="flex justify-end gap-3">
                        <!-- Add Mode Buttons -->
                        <div id="addModeButtons" style="gap: 1rem;">
                            <button type="button" id="loadPreviewBtn" class="form-button bg-white hover:bg-gray-100 text-black">
                                <i data-lucide="eye" class="w-4 h-4 mr-2"></i>
                                Preview
                            </button>
                            <button type="button" id="saveDraftBtn" class="form-button bg-gray-600 hover:bg-gray-700 text-white">
                                <i data-lucide="file-text" class="w-4 h-4 mr-2"></i>
                                Draft
                            </button>
                            <button type="submit" id="savePublishBtn" class="form-button bg-green-600 hover:bg-green-700 text-white">
                                <i data-lucide="send" class="w-4 h-4 mr-2"></i>
                                Publish
                            </button>
                        </div>
                        
                        <!-- Edit Mode Buttons -->
                        <div id="editModeButtons" style="display: none; gap: 1rem;">
                            <button type="button" id="loadPreviewEditBtn" class="form-button bg-white hover:bg-gray-100 text-black">
                                <i data-lucide="eye" class="w-4 h-4 mr-2"></i>
                                Preview
                            </button>
                            <button type="button" id="deleteBlogBtn" class="form-button bg-red-600 hover:bg-red-700 text-white">
                                <div class="flex items-center gap-2">
                                    <i data-lucide="trash-2" class="w-4 h-4"></i>
                                    <p>Delete</p>
                                </div>
                            </button>
                            <button type="button" id="updateBlogBtn" class="form-button bg-white/10 hover:bg-white/20 border border-white/20 text-white">
                                <div class="flex items-center gap-2">
                                    <i data-lucide="save" class="w-4 h-4"></i>
                                    <p>Update</p>
                                </div>
                            </button>
                        </div>
                    </div>
                    
                </form>
            </div>
        </section>

        <!-- Edit/Delete Blog Section -->
        <section id="editBlogs" class="content-section">
            <div class="form-container">
                <h2 class="section-title text-center">Edit/Delete Blog</h2>
                <div class="section-content">
                    

                    <!-- Filters -->
                    <div class="form-row mb-4">
                        <div class="form-item">
                            <label class="form-label" for="filterTitle"><i data-lucide="type" class="w-4 h-4 inline mr-2"></i>Filter by Title</label>
                            <input type="text" id="filterTitle" class="form-input" placeholder="Enter title...">
                        </div>
                        <div class="form-item">
                            <label class="form-label" for="filterAuthor"><i data-lucide="user" class="w-4 h-4 inline mr-2"></i>Filter by Author</label>
                            <input type="text" id="filterAuthor" class="form-input" placeholder="Enter author name...">
                        </div>
                    </div>
                    <div class="form-row mb-6">
                        <div class="form-item">
                            <label class="form-label" for="filterCategory"><i data-lucide="tag" class="w-4 h-4 inline mr-2"></i>Filter by Category</label>
                            <select id="filterCategory" class="form-input" style="background-color: rgba(255, 255, 255, 0.05); border: 1px solid rgba(255, 255, 255, 0.2); color: white;">
                                <option value="ALL" style="background-color: #1a1a1a; color: white;">ALL</option>
                                <option value="BUSINESS" style="background-color: #1a1a1a; color: white;">BUSINESS</option>
                                <option value="TECHNOLOGY" style="background-color: #1a1a1a; color: white;">TECHNOLOGY</option>
                                <option value="GCC" style="background-color: #1a1a1a; color: white;">GCC</option>
                                <option value="SUSTAINABILITY" style="background-color: #1a1a1a; color: white;">SUSTAINABILITY</option>
                                <option value="SEMICONDUCTOR" style="background-color: #1a1a1a; color: white;">SEMICONDUCTOR</option>
                            </select>
                        </div>
                        <div class="form-item">
                            <label class="form-label" for="filterKeywords"><i data-lucide="tags" class="w-4 h-4 inline mr-2"></i>Filter by Keywords</label>
                            <input type="text" id="filterKeywords" class="form-input" placeholder="Enter keywords...">
                        </div>
                    </div>

                    <!-- Loading State -->
                    <div id="blogsLoading" class="text-center py-8 hidden">
                        <i data-lucide="loader-2" class="w-6 h-6 animate-spin mx-auto mb-2 text-white/60"></i>
                        <p class="text-white/60">Loading blogs...</p>
                    </div>

                    <!-- No Results State -->
                    <div id="noBlogsFound" class="text-center py-8 hidden">
                        <i data-lucide="file-x" class="w-12 h-12 mx-auto mb-4 text-white/40"></i>
                        <h3 class="text-lg font-semibold mb-2 text-white/80">No blogs found</h3>
                        <p class="text-white/60">Try adjusting your search terms or check back later.</p>
                    </div>

                    <!-- Blogs List Container -->
                    <div id="blogsList" class="space-y-4">
                        <!-- Dynamic blog entries will be inserted here -->
                    </div>

                    <!-- Pagination Controls -->
                    <div id="paginationControls" class="flex justify-center items-center gap-4 mt-6 hidden">
                        <button id="prevPage" class="form-button bg-white/10 hover:bg-white/20 border border-white/20 text-white text-xs px-3 py-2 disabled:opacity-50 disabled:cursor-not-allowed">
                            <div class="flex items-center gap-2">
                                <i data-lucide="chevron-left" class="w-3 h-3"></i>
                                <p>Previous</p>
                            </div>
                        </button>
                        <span id="pageInfo" class="text-sm text-white/60 px-4">
                            Page 1 of 1
                        </span>
                        <button id="nextPage" class="form-button bg-white/10 hover:bg-white/20 border border-white/20 text-white text-xs px-3 py-2 disabled:opacity-50 disabled:cursor-not-allowed">
                            <div class="flex items-center gap-2">
                                <p>Next</p>
                                <i data-lucide="chevron-right" class="w-3 h-3"></i>
                            </div>
                        </button>
                    </div>
                </div>
            </div>
        </section>

        <!-- Manage Images Section -->
        <!-- <section id="manageImages" class="content-section">
            <div class="form-container">
                <h2 class="section-title">Manage Images</h2>
                <div class="section-content">
                    <div class="mb-6">
                        <label class="form-label" for="imageUpload">Upload New Image</label>
                        <input
                            type="file"
                            id="imageUpload"
                            accept="image/*"
                            class="form-input"
                            style="padding-top: 0.375rem; padding-bottom: 0.375rem;"
                        />
                        <button class="form-button mt-2">
                            <i data-lucide="upload" class="w-4 h-4 mr-2"></i>
                            Upload Image
                        </button>
                    </div>
                    <div class="grid grid-cols-2 md:grid-cols-3 gap-4">
                        <div class="relative group">
                            <div class="aspect-square bg-white/5 rounded-lg border border-white/10 flex items-center justify-center">
                                <i data-lucide="image" class="w-8 h-8 text-white/40"></i>
                            </div>
                            <div class="absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity rounded-lg flex items-center justify-center">
                                <div class="flex gap-2">
                                    <button class="form-button text-xs px-2 py-1">
                                        <i data-lucide="eye" class="w-3 h-3"></i>
                                    </button>
                                    <button class="form-button bg-red-600 hover:bg-red-700 text-xs px-2 py-1">
                                        <i data-lucide="trash-2" class="w-3 h-3"></i>
                                    </button>
                                </div>
                            </div>
                            <p class="text-xs text-white/60 mt-2 text-center">image1.jpg</p>
                        </div>
                        <div class="relative group">
                            <div class="aspect-square bg-white/5 rounded-lg border border-white/10 flex items-center justify-center">
                                <i data-lucide="image" class="w-8 h-8 text-white/40"></i>
                            </div>
                            <div class="absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity rounded-lg flex items-center justify-center">
                                <div class="flex gap-2">
                                    <button class="form-button text-xs px-2 py-1">
                                        <i data-lucide="eye" class="w-3 h-3"></i>
                                    </button>
                                    <button class="form-button bg-red-600 hover:bg-red-700 text-xs px-2 py-1">
                                        <i data-lucide="trash-2" class="w-3 h-3"></i>
                                    </button>
                                </div>
                            </div>
                            <p class="text-xs text-white/60 mt-2 text-center">image2.jpg</p>
                        </div>
                        <div class="relative group">
                            <div class="aspect-square bg-white/5 rounded-lg border border-white/10 flex items-center justify-center">
                                <i data-lucide="image" class="w-8 h-8 text-white/40"></i>
                            </div>
                            <div class="absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity rounded-lg flex items-center justify-center">
                                <div class="flex gap-2">
                                    <button class="form-button text-xs px-2 py-1">
                                        <i data-lucide="eye" class="w-3 h-3"></i>
                                    </button>
                                    <button class="form-button bg-red-600 hover:bg-red-700 text-xs px-2 py-1">
                                        <i data-lucide="trash-2" class="w-3 h-3"></i>
                                    </button>
                                </div>
                            </div>
                            <p class="text-xs text-white/60 mt-2 text-center">image3.jpg</p>
                        </div>
                    </div>
                </div>
            </div>
        </section> -->
            </div>
        </div>
    </main>
    
    <!-- Modal for displaying messages -->
    <div id="messageModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modalTitle" class="modal-title">Message</h3>
                <button type="button" class="modal-close" onclick="closeModal()">
                    <i data-lucide="x" class="w-5 h-5"></i>
                </button>
            </div>
            <div class="modal-body">
                <p id="modalMessage">Message content goes here.</p>
            </div>
        </div>
    </div>
    
    <!-- Link Dialog Modal -->
    <div id="linkModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Add Hyperlink</h3>
                <button type="button" class="modal-close" onclick="closeLinkModal()">
                    <i data-lucide="x" class="w-5 h-5"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="space-y-4">
                    <div class="form-item">
                        <label class="form-label" for="linkUrl">
                            <i data-lucide="link" class="w-4 h-4 inline mr-2"></i>URL <span class="text-red-400">*</span>
                        </label>
                        <input
                            type="url"
                            id="linkUrl"
                            class="form-input"
                            placeholder="https://example.com"
                            required
                        />
                    </div>
                    <div class="form-item">
                        <label class="form-label" for="linkDisplayName">
                            <i data-lucide="type" class="w-4 h-4 inline mr-2"></i>Display Text <span class="text-red-400">*</span>
                        </label>
                        <input
                            type="text"
                            id="linkDisplayName"
                            class="form-input"
                            placeholder="Link text to display"
                            required
                        />
                    </div>
                </div>
                <div class="flex justify-end gap-3 mt-6">
                    <button type="button" class="modal-button modal-button-secondary" onclick="closeLinkModal()">
                        <div class="flex items-center gap-2">
                            <p>Cancel</p>
                        </div>
                    </button>
                    <button type="button" class="modal-button modal-button-primary" onclick="insertLink()">
                        <div class="flex items-center gap-2">
                            <i data-lucide="plus" class="w-4 h-4"></i>
                            <p>Add Link</p>
                        </div>
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Bullet Points Dialog Modal -->
    <div id="bulletModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Add Bullet Points</h3>
                <button type="button" class="modal-close" onclick="closeBulletModal()">
                    <i data-lucide="x" class="w-5 h-5"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="space-y-4">
                    <div class="form-item">
                        <label class="form-label">
                            <i data-lucide="list" class="w-4 h-4 inline mr-2"></i>Bullet Points
                        </label>
                        <p class="text-xs text-white/60 mb-2">Add one bullet point per line. Empty lines will be ignored.</p>
                        <div id="bulletPointsContainer" class="space-y-2">
                            <div class="bullet-point-item flex items-center gap-2">
                                <input type="text" class="bullet-input form-input flex-1" placeholder="Bullet point 1" />
                                <button type="button" class="remove-bullet-btn text-white/50 hover:text-red-500 transition-colors p-1" title="Remove">
                                    <i data-lucide="x" class="w-4 h-4"></i>
                                </button>
                            </div>
                            <div class="bullet-point-item flex items-center gap-2">
                                <input type="text" class="bullet-input form-input flex-1" placeholder="Bullet point 2" />
                                <button type="button" class="remove-bullet-btn text-white/50 hover:text-red-500 transition-colors p-1" title="Remove">
                                    <i data-lucide="x" class="w-4 h-4"></i>
                                </button>
                            </div>
                        </div>
                        <button type="button" id="addBulletBtn" class="mt-3 text-sm text-blue-400 hover:text-blue-300 flex items-center gap-1">
                            <i data-lucide="plus" class="w-4 h-4"></i>
                            Add another bullet point
                        </button>
                    </div>
                </div>
                <div class="flex justify-end gap-3 mt-6">
                    <button type="button" class="modal-button modal-button-secondary" onclick="closeBulletModal()">
                        <div class="flex items-center gap-2">
                            <p>Cancel</p>
                        </div>
                    </button>
                    <button type="button" class="modal-button modal-button-primary" onclick="insertBulletList()">
                        <div class="flex items-center gap-2">
                            <i data-lucide="list" class="w-4 h-4"></i>
                            <p>Add Bullet List</p>
                        </div>
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Delete Confirmation Dialog Modal -->
    <div id="deleteConfirmModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Confirm Blog Deletion</h3>
                <button type="button" class="modal-close" onclick="closeDeleteConfirmModal()">
                    <i data-lucide="x" class="w-5 h-5"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="space-y-4">
                    <div class="p-4 bg-red-600/10 border border-red-600/20 rounded-lg">
                        <div class="flex items-start gap-3">
                            <i data-lucide="alert-triangle" class="w-5 h-5 text-red-400 mt-0.5 flex-shrink-0"></i>
                            <div>
                                <h4 class="text-red-400 font-medium mb-1">Warning: This action will mark the blog as deleted</h4>
                                <p class="text-white/80 text-sm">You are about to mark the following blog as deleted:</p>
                                <p id="deleteBlogTitle" class="text-white font-medium mt-2 break-words"></p>
                                <p class="text-white/60 text-xs mt-2">Note: The blog will be marked as deleted but not permanently removed from the database.</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-item">
                        <label class="form-label" for="redirectUrl">
                            <i data-lucide="external-link" class="w-4 h-4 inline mr-2"></i>Redirect URL <span class="text-white/50 text-xs">(Optional)</span>
                        </label>
                        <input
                            type="url"
                            id="redirectUrl"
                            class="form-input"
                            placeholder="https://example.com/new-page"
                        />
                        <p class="text-xs text-white/50 mt-1">
                            If provided, visitors to the deleted blog will be redirected to this URL.
                            If left blank, a 403 Forbidden page will be shown.
                        </p>
                    </div>
                    
                    <div class="form-item">
                        <label class="flex items-start gap-2 cursor-pointer">
                            <input type="checkbox" id="confirmDeleteCheckbox" class="mt-1 w-4 h-4 text-red-600 bg-gray-100 border-gray-300 rounded focus:ring-red-500">
                            <span class="text-sm text-white/80">
                                I understand that this blog will be marked as deleted and will no longer be accessible to visitors.
                            </span>
                        </label>
                    </div>
                </div>
                
                <div class="flex justify-end gap-3 mt-6">
                    <button type="button" class="modal-button modal-button-secondary" onclick="closeDeleteConfirmModal()">
                        <div class="flex items-center gap-2">
                            <p>Cancel</p>
                        </div>
                    </button>
                    <button type="button" id="confirmDeleteBtn" class="modal-button bg-red-600 hover:bg-red-700 text-white" onclick="confirmDeleteBlog()" disabled>
                        <div class="flex items-center gap-2">
                            <i data-lucide="trash-2" class="w-4 h-4"></i>
                            <p>Mark as Deleted</p>
                        </div>
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Blog URL Display Modal -->
    <div id="blogUrlModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Blog URL</h3>
                <button type="button" class="modal-close" onclick="closeBlogUrlModal()">
                    <i data-lucide="x" class="w-5 h-5"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="space-y-4">
                    <div class="form-item">
                        <label class="form-label">
                            <i data-lucide="file-text" class="w-4 h-4 inline mr-2"></i>Blog Title
                        </label>
                        <p id="urlBlogTitle" class="text-white/80 bg-white/5 p-3 rounded-lg border border-white/10 break-words"></p>
                    </div>
                    
                    <div class="form-item">
                        <label class="form-label">
                            <i data-lucide="external-link" class="w-4 h-4 inline mr-2"></i>Blog URL
                        </label>
                        <div class="flex items-center gap-2">
                            <input
                                type="text"
                                id="blogUrlDisplay"
                                class="form-input flex-1"
                                readonly
                            />
                            <button
                                type="button"
                                id="copyUrlBtn"
                                class="form-button bg-white/10 hover:bg-white/20 border border-white/20 text-white px-3 py-2"
                                onclick="copyBlogUrl()"
                                title="Copy URL to clipboard"
                            >
                                <div class="flex items-center gap-2">
                                    <i data-lucide="copy" class="w-4 h-4"></i>
                                </div>
                            </button>
                        </div>
                        <p class="text-xs text-white/50 mt-1">
                            Click the copy button to copy the URL to your clipboard, or click "Open" to visit the blog.
                        </p>
                    </div>
                </div>
                
                <div class="flex justify-end gap-3 mt-6">
                    <button type="button" class="modal-button modal-button-secondary" onclick="closeBlogUrlModal()">
                        <div class="flex items-center gap-2">
                            <p>Close</p>
                        </div>
                    </button>
                    <button type="button" id="openBlogBtn" class="modal-button modal-button-primary" onclick="openBlogInNewTab()">
                        <div class="flex items-center gap-2">
                            <i data-lucide="external-link" class="w-4 h-4"></i>
                            <p>Open Blog</p>
                        </div>
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.9.359/pdf.min.js"></script>
    <script>
       
        function showModal(title, message, type = 'info') {
            const modal = document.getElementById('messageModal');
            const modalTitle = document.getElementById('modalTitle');
            const modalMessage = document.getElementById('modalMessage');
            const modalContent = modal.querySelector('.modal-content');
            
           
            modalTitle.textContent = title;
            modalMessage.style.whiteSpace = 'pre-line';
            
           
            const urlRegex = /(https?:\/\/[^\\s]+)/g;
            if (urlRegex.test(message)) {
                modalMessage.innerHTML = message.replace(urlRegex, '<a href="$1" target="_blank" rel="noopener noreferrer" class="modal-url-link">$1</a>');
            } else {
                modalMessage.textContent = message;
            }
            
           
            modalContent.classList.remove('error-modal', 'success-modal');
            
           
            if (type === 'error') {
                modalContent.classList.add('error-modal');
            } else if (type === 'success') {
                modalContent.classList.add('success-modal');
            }
            
           
            modal.classList.add('show');
            
           
            lucide.createIcons();
        }
        
        function closeModal() {
            const modal = document.getElementById('messageModal');
            modal.classList.remove('show');
        }

        
       
        document.addEventListener('click', function(event) {
            const modal = document.getElementById('messageModal');
            if (event.target === modal) {
                closeModal();
            }
        });
        
       
        document.addEventListener('keydown', function(event) {
            if (event.key === 'Escape') {
                closeModal();
                closeLinkModal();
                closeBulletModal();
                closeDeleteConfirmModal();
                closeBlogUrlModal();
            }
        });
        
        // Link dialog variables
        let currentLinkTextInput = null;
        let currentLinkSelectedText = '';
        let currentLinkBeforeText = '';
        let currentLinkAfterText = '';
        let currentLinkStart = 0;
        
        function showLinkDialog(textInput, selectedText, beforeText, afterText, start) {
            currentLinkTextInput = textInput;
            currentLinkSelectedText = selectedText;
            currentLinkBeforeText = beforeText;
            currentLinkAfterText = afterText;
            currentLinkStart = start;
            
            const linkModal = document.getElementById('linkModal');
            const linkUrlInput = document.getElementById('linkUrl');
            const linkDisplayNameInput = document.getElementById('linkDisplayName');
            
            // Clear previous values
            linkUrlInput.value = '';
            linkDisplayNameInput.value = selectedText || '';
            
            // Show modal
            linkModal.classList.add('show');
            
            // Focus on URL input
            setTimeout(() => {
                linkUrlInput.focus();
            }, 100);
            
            // Recreate icons
            lucide.createIcons();
        }
        
        function closeLinkModal() {
            const linkModal = document.getElementById('linkModal');
            linkModal.classList.remove('show');
            
            // Clear variables
            currentLinkTextInput = null;
            currentLinkSelectedText = '';
            currentLinkBeforeText = '';
            currentLinkAfterText = '';
            currentLinkStart = 0;
        }
        
        function insertLink() {
            const linkUrl = document.getElementById('linkUrl').value.trim();
            const linkDisplayName = document.getElementById('linkDisplayName').value.trim();
            
            // Validation
            if (!linkUrl) {
                alert('Please enter a URL');
                document.getElementById('linkUrl').focus();
                return;
            }
            
            if (!linkDisplayName) {
                alert('Please enter display text for the link');
                document.getElementById('linkDisplayName').focus();
                return;
            }
            
            // Basic URL validation
            try {
                new URL(linkUrl);
            } catch (e) {
                alert('Please enter a valid URL (including http:// or https://)//');
                document.getElementById('linkUrl').focus();
                return;
            }
            
            // Insert the link
            const formattedText = `<a href="${linkUrl}">${linkDisplayName}</a>`;
            
            if (currentLinkTextInput) {
                currentLinkTextInput.value = currentLinkBeforeText + formattedText + currentLinkAfterText;
                
                // Set cursor position after the inserted text
                const newCursorPos = currentLinkStart + formattedText.length;
                currentLinkTextInput.setSelectionRange(newCursorPos, newCursorPos);
                currentLinkTextInput.focus();
            }
            
            // Close modal
            closeLinkModal();
        }
        
        // Handle Enter key in link modal
        document.addEventListener('keydown', function(event) {
            const linkModal = document.getElementById('linkModal');
            if (linkModal && linkModal.classList.contains('show')) {
                if (event.key === 'Enter') {
                    event.preventDefault();
                    insertLink();
                }
            }
        });
        
        // Close link modal when clicking outside
        document.addEventListener('click', function(event) {
            const linkModal = document.getElementById('linkModal');
            if (event.target === linkModal) {
                closeLinkModal();
            }
        });
        
        // Bullet dialog variables
        let currentBulletTextInput = null;
        let currentBulletSelectedText = '';
        let currentBulletBeforeText = '';
        let currentBulletAfterText = '';
        let currentBulletStart = 0;
        
        function showBulletDialog(textInput, selectedText, beforeText, afterText, start) {
            currentBulletTextInput = textInput;
            currentBulletSelectedText = selectedText;
            currentBulletBeforeText = beforeText;
            currentBulletAfterText = afterText;
            currentBulletStart = start;
            
            const bulletModal = document.getElementById('bulletModal');
            const bulletInputs = document.querySelectorAll('.bullet-input');
            
            // Clear previous values
            bulletInputs.forEach(input => input.value = '');
            
            // Pre-populate with selected text if available
            if (selectedText) {
                const lines = selectedText.split('\n').filter(line => line.trim());
                lines.forEach((line, index) => {
                    if (index < bulletInputs.length) {
                        bulletInputs[index].value = line.trim();
                    } else {
                        // Add more bullet points if needed
                        addBulletPoint(line.trim());
                    }
                });
            }
            
            // Show modal
            bulletModal.classList.add('show');
            
            // Focus on first input
            setTimeout(() => {
                const firstInput = document.querySelector('.bullet-input');
                if (firstInput) firstInput.focus();
            }, 100);
            
            // Recreate icons
            lucide.createIcons();
        }
        
        function closeBulletModal() {
            const bulletModal = document.getElementById('bulletModal');
            bulletModal.classList.remove('show');
            
            // Reset to default 2 bullet points
            resetBulletPoints();
            
            // Clear variables
            currentBulletTextInput = null;
            currentBulletSelectedText = '';
            currentBulletBeforeText = '';
            currentBulletAfterText = '';
            currentBulletStart = 0;
        }
        
        function addBulletPoint(value = '') {
            const container = document.getElementById('bulletPointsContainer');
            const bulletCount = container.children.length + 1;
            
            const bulletItem = document.createElement('div');
            bulletItem.className = 'bullet-point-item flex items-center gap-2';
            bulletItem.innerHTML = `
                <input type="text" class="bullet-input form-input flex-1" placeholder="Bullet point ${bulletCount}" value="${value}" />
                <button type="button" class="remove-bullet-btn text-white/50 hover:text-red-500 transition-colors p-1" title="Remove">
                    <i data-lucide="x" class="w-4 h-4"></i>
                </button>
            `;
            
            container.appendChild(bulletItem);
            lucide.createIcons();
            
            // Focus on the new input
            const newInput = bulletItem.querySelector('.bullet-input');
            if (newInput) newInput.focus();
        }
        
        function resetBulletPoints() {
            const container = document.getElementById('bulletPointsContainer');
            container.innerHTML = `
                <div class="bullet-point-item flex items-center gap-2">
                    <input type="text" class="bullet-input form-input flex-1" placeholder="Bullet point 1" />
                    <button type="button" class="remove-bullet-btn text-white/50 hover:text-red-500 transition-colors p-1" title="Remove">
                        <i data-lucide="x" class="w-4 h-4"></i>
                    </button>
                </div>
                <div class="bullet-point-item flex items-center gap-2">
                    <input type="text" class="bullet-input form-input flex-1" placeholder="Bullet point 2" />
                    <button type="button" class="remove-bullet-btn text-white/50 hover:text-red-500 transition-colors p-1" title="Remove">
                        <i data-lucide="x" class="w-4 h-4"></i>
                    </button>
                </div>
            `;
            lucide.createIcons();
        }
        
        function insertBulletList() {
            const bulletInputs = document.querySelectorAll('.bullet-input');
            const bulletPoints = [];
            
            // Collect non-empty bullet points
            bulletInputs.forEach(input => {
                const value = input.value.trim();
                if (value) {
                    bulletPoints.push(value);
                }
            });
            
            // Validation
            if (bulletPoints.length === 0) {
                alert('Please enter at least one bullet point');
                const firstInput = document.querySelector('.bullet-input');
                if (firstInput) firstInput.focus();
                return;
            }
            
            // Create HTML list
            const listItems = bulletPoints.map(point => `<li>  ${point}</li>`);
            const formattedText = `<ul>\n${listItems.join('\n')}\n</ul>`;
            
            if (currentBulletTextInput) {
                currentBulletTextInput.value = currentBulletBeforeText + formattedText + currentBulletAfterText;
                
                // Set cursor position after the inserted text
                const newCursorPos = currentBulletStart + formattedText.length;
                currentBulletTextInput.setSelectionRange(newCursorPos, newCursorPos);
                currentBulletTextInput.focus();
            }
            
            // Close modal
            closeBulletModal();
        }
        
        // Event listeners for bullet modal
        document.addEventListener('click', function(event) {
            // Add bullet point button
            if (event.target.id === 'addBulletBtn' || event.target.closest('#addBulletBtn')) {
                event.preventDefault();
                addBulletPoint();
            }
            
            // Remove bullet point button
            if (event.target.closest('.remove-bullet-btn')) {
                event.preventDefault();
                const bulletItem = event.target.closest('.bullet-point-item');
                const container = document.getElementById('bulletPointsContainer');
                
                // Don't allow removing if only one bullet point remains
                if (container.children.length > 1) {
                    bulletItem.remove();
                } else {
                    // Just clear the input instead of removing it
                    const input = bulletItem.querySelector('.bullet-input');
                    if (input) input.value = '';
                }
            }
            
            // Close bullet modal when clicking outside
            const bulletModal = document.getElementById('bulletModal');
            if (event.target === bulletModal) {
                closeBulletModal();
            }
        });
        
        // Handle Enter key in bullet modal
        document.addEventListener('keydown', function(event) {
            const bulletModal = document.getElementById('bulletModal');
            if (bulletModal && bulletModal.classList.contains('show')) {
                if (event.key === 'Enter') {
                    // If user is in an input field, add a new bullet point
                    if (event.target.classList.contains('bullet-input')) {
                        event.preventDefault();
                        addBulletPoint();
                    } else {
                        // Otherwise, insert the bullet list
                        event.preventDefault();
                        insertBulletList();
                    }
                } else if (event.key === 'Escape') {
                    event.preventDefault();
                    closeBulletModal();
                }
            }
        });
        
        // Delete confirmation dialog variables
        let currentDeleteBlogId = null;
        let currentDeleteBlogTitle = '';
        
        function showDeleteConfirmModal(blogId, blogTitle) {
            currentDeleteBlogId = blogId;
            currentDeleteBlogTitle = blogTitle;
            
            const deleteModal = document.getElementById('deleteConfirmModal');
            const deleteBlogTitleElement = document.getElementById('deleteBlogTitle');
            const redirectUrlInput = document.getElementById('redirectUrl');
            const confirmCheckbox = document.getElementById('confirmDeleteCheckbox');
            const confirmDeleteBtn = document.getElementById('confirmDeleteBtn');
            
            // Set blog title
            deleteBlogTitleElement.textContent = blogTitle;
            
            // Clear previous values
            redirectUrlInput.value = '';
            confirmCheckbox.checked = false;
            confirmDeleteBtn.disabled = true;
            
            // Show modal
            deleteModal.classList.add('show');
            
            // Recreate icons
            lucide.createIcons();
        }
        
        function closeDeleteConfirmModal() {
            const deleteModal = document.getElementById('deleteConfirmModal');
            deleteModal.classList.remove('show');
            
            // Clear variables
            currentDeleteBlogId = null;
            currentDeleteBlogTitle = '';
        }
        
        function updateDeleteButtonState() {
            const confirmCheckbox = document.getElementById('confirmDeleteCheckbox');
            const confirmDeleteBtn = document.getElementById('confirmDeleteBtn');
            
            confirmDeleteBtn.disabled = !confirmCheckbox.checked;
        }
        
        async function confirmDeleteBlog() {
            if (!currentDeleteBlogId) {
                showModal('Error', 'No blog selected for deletion', 'error');
                return;
            }
            
            const redirectUrl = document.getElementById('redirectUrl').value.trim();
            const confirmDeleteBtn = document.getElementById('confirmDeleteBtn');
            
            // Validate redirect URL if provided
            if (redirectUrl) {
                try {
                    new URL(redirectUrl);
                } catch (e) {
                    alert('Please enter a valid redirect URL (including http:// or https://)');
                    document.getElementById('redirectUrl').focus();
                    return;
                }
            }
            
            try {
                // Update button state
                const originalText = confirmDeleteBtn.innerHTML;
                confirmDeleteBtn.innerHTML = '<i data-lucide="loader-2" class="w-4 h-4 mr-2 animate-spin"></i>Deleting...';
                confirmDeleteBtn.disabled = true;
                
                const response = await fetch('/delete_blog', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        blog_id: currentDeleteBlogId,
                        redirect_url: redirectUrl || null
                    })
                });
                
                // Reset button state
                confirmDeleteBtn.innerHTML = originalText;
                confirmDeleteBtn.disabled = false;
                
                const result = await response.json();
                
                if (result.status === 'success') {
                    let message = `Blog "${currentDeleteBlogTitle}" has been marked as deleted successfully.`;
                    if (redirectUrl) {
                        message += `\n\nVisitors will be redirected to: ${redirectUrl}`;
                    } else {
                        message += `\n\nVisitors will see a 403 Forbidden page when trying to access this blog.`;
                    }
                    
                    showModal('Success', message, 'success');
                    
                    // Close modal
                    closeDeleteConfirmModal();
                    
                    // Refresh the blog list
                    fetchBlogs();
                } else {
                    showModal('Error', result.message || 'Failed to mark blog as deleted', 'error');
                }
                
            } catch (error) {
                console.error('Error deleting blog:', error);
                
                // Reset button state
                confirmDeleteBtn.innerHTML = '<i data-lucide="trash-2" class="w-4 h-4 mr-2"></i>Delete Blog';
                confirmDeleteBtn.disabled = false;
                
                showModal('Error', 'An error occurred while deleting the blog. Please try again.', 'error');
            }
        }
        
        // Event listeners for delete confirmation modal
        document.addEventListener('change', function(event) {
            if (event.target.id === 'confirmDeleteCheckbox') {
                updateDeleteButtonState();
            }
        });
        
        // Close delete modal when clicking outside
        document.addEventListener('click', function(event) {
            const deleteModal = document.getElementById('deleteConfirmModal');
            if (event.target === deleteModal) {
                closeDeleteConfirmModal();
            }
        });
        
        // Handle Enter key in delete modal
        document.addEventListener('keydown', function(event) {
            const deleteModal = document.getElementById('deleteConfirmModal');
            if (deleteModal && deleteModal.classList.contains('show')) {
                if (event.key === 'Enter') {
                    event.preventDefault();
                    const confirmCheckbox = document.getElementById('confirmDeleteCheckbox');
                    if (confirmCheckbox.checked) {
                        confirmDeleteBlog();
                    }
                } else if (event.key === 'Escape') {
                    event.preventDefault();
                    closeDeleteConfirmModal();
                }
            }
        });
        
        // Blog URL display modal variables
        let currentBlogUrl = '';
        
        function showBlogUrl(blogId, blogTitle) {
            blogId = blogId.replace("[quotetation_here]", "'");
            blogTitle = blogTitle.replace("[quotetation_here]", "'");
            
            if (!blogId) {
                showModal('Error', 'Blog ID not found', 'error');
                return;
            }
            
            // Generate blog URL based on blog ID
            const baseUrl = window.location.origin;
            const blogUrl = `${baseUrl}/blog/${blogId}`;
            currentBlogUrl = blogUrl;
            
            const urlModal = document.getElementById('blogUrlModal');
            const urlBlogTitle = document.getElementById('urlBlogTitle');
            const blogUrlDisplay = document.getElementById('blogUrlDisplay');
            
            // Set blog title and URL
            urlBlogTitle.textContent = blogTitle;
            blogUrlDisplay.value = blogUrl;
            
            // Show modal
            urlModal.classList.add('show');
            
            // Recreate icons
            lucide.createIcons();
        }
        
        function closeBlogUrlModal() {
            const urlModal = document.getElementById('blogUrlModal');
            urlModal.classList.remove('show');
            
            // Clear variables
            currentBlogUrl = '';
        }
        
        function copyBlogUrl() {
            const blogUrlDisplay = document.getElementById('blogUrlDisplay');
            const copyBtn = document.getElementById('copyUrlBtn');
            
            // Select and copy the URL
            blogUrlDisplay.select();
            blogUrlDisplay.setSelectionRange(0, 99999); // For mobile devices
            
            if (navigator.clipboard && window.isSecureContext) {
                navigator.clipboard.writeText(currentBlogUrl).then(() => {
                    showCopyFeedback(copyBtn, 'Copied!');
                }).catch(() => {
                    fallbackCopyTextToClipboard(currentBlogUrl, copyBtn);
                });
            } else {
                fallbackCopyTextToClipboard(currentBlogUrl, copyBtn);
            }
        }
        
        function openBlogInNewTab() {
            if (currentBlogUrl) {
                window.open(currentBlogUrl, '_blank', 'noopener,noreferrer');
            }
        }
        
        function showCopyFeedback(button, message) {
            const originalContent = button.innerHTML;
            button.innerHTML = `<i data-lucide="check" class="w-4 h-4"></i>`;
            button.classList.add('bg-green-600', 'hover:bg-green-700');
            button.classList.remove('bg-blue-600', 'hover:bg-blue-700');
            
            // Recreate icons for the check mark
            lucide.createIcons();
            
            setTimeout(() => {
                button.innerHTML = originalContent;
                button.classList.remove('bg-green-600', 'hover:bg-green-700');
                button.classList.add('bg-blue-600', 'hover:bg-blue-700');
                lucide.createIcons();
            }, 2000);
        }
        
        function fallbackCopyTextToClipboard(text, button) {
            const textArea = document.createElement("textarea");
            textArea.value = text;
            textArea.style.position = "fixed";
            textArea.style.top = "0";
            textArea.style.left = "0";
            textArea.style.width = "2em";
            textArea.style.height = "2em";
            textArea.style.padding = "0";
            textArea.style.border = "none";
            textArea.style.outline = "none";
            textArea.style.boxShadow = "none";
            textArea.style.background = "transparent";
            document.body.appendChild(textArea);
            textArea.focus();
            textArea.select();
            
            try {
                document.execCommand('copy');
                showCopyFeedback(button, 'Copied!');
            } catch (err) {
                console.error('Failed to copy URL', err);
                showModal('Copy Failed', 'Unable to copy URL to clipboard. Please select and copy manually.', 'error');
            }
            
            document.body.removeChild(textArea);
        }
        
        // Close blog URL modal when clicking outside
        document.addEventListener('click', function(event) {
            const urlModal = document.getElementById('blogUrlModal');
            if (event.target === urlModal) {
                closeBlogUrlModal();
            }
        });
        
        // Handle Enter key in blog URL modal
        document.addEventListener('keydown', function(event) {
            const urlModal = document.getElementById('blogUrlModal');
            if (urlModal && urlModal.classList.contains('show')) {
                if (event.key === 'Enter') {
                    event.preventDefault();
                    openBlogInNewTab();
                } else if (event.key === 'Escape') {
                    event.preventDefault();
                    closeBlogUrlModal();
                }
            }
        });
        
        class ExpandableTabs {
            constructor(container, options = {}) {
                this.container = container;
                this.tabs = options.tabs || [];
                this.activeColor = options.activeColor || 'text-blue-600';
                this.onChange = options.onChange || (() => {});
                this.selected = null;
                this.init();
            }
            init() {
                this.render();
                this.bindEvents();
            }
            render() {
                this.container.innerHTML = '';
                this.tabs.forEach((tab, index) => {
                    if (tab.type === 'separator') {
                        const separator = this.createSeparator();
                        this.container.appendChild(separator);
                    } else {
                        const button = this.createTabButton(tab, index);
                        this.container.appendChild(button);
                    }
                });
            }
            createSeparator() {
                const separator = document.createElement('div');
                separator.className = 'separator';
                separator.style.background = 'rgba(255, 255, 255, 0.3)';
                separator.setAttribute('aria-hidden', 'true');
                return separator;
            }
            createTabButton(tab, index) {
                const button = document.createElement('button');
                const isSelected = this.selected === index;
                button.className = `tab-button relative flex items-center text-sm font-medium tracking-wide transition-all duration-[600ms] ${
                    isSelected ? 'selected' : ''
                }`;
                if (isSelected) {
                    button.style.color = this.activeColor || 'rgb(147, 197, 253)';
                } else {
                    button.style.color = 'rgba(255, 255, 255, 0.6)';
                }
                button.dataset.index = index;
                const iconWrapper = document.createElement('div');
                iconWrapper.className = 'flex-shrink-0';
                iconWrapper.innerHTML = `<i data-lucide="${tab.icon}" class="w-4 h-4"></i>`;
                const textElement = document.createElement('span');
                textElement.className = `tab-text ${isSelected ? 'expanded' : ''}`;
                textElement.textContent = tab.title;
                button.appendChild(iconWrapper);
                button.appendChild(textElement);
                button.addEventListener('mouseenter', () => {
                    if (!button.classList.contains('selected')) {
                        button.style.color = 'rgba(255, 255, 255, 0.9)';
                    }
                });
                button.addEventListener('mouseleave', () => {
                    if (!button.classList.contains('selected')) {
                        button.style.color = 'rgba(255, 255, 255, 0.6)';
                    }
                });
                return button;
            }
            handleSelect(index) {
                this.selected = index;
                const buttons = this.container.querySelectorAll('.tab-button');
                buttons.forEach((button, i) => {
                    const buttonIndex = parseInt(button.dataset.index);
                    const textElement = button.querySelector('.tab-text');
                    if (this.selected === buttonIndex) {
                        button.classList.add('selected');
                        button.style.color = this.activeColor || 'rgb(147, 197, 253)';
                        textElement.classList.add('expanded');
                    } else {
                        button.classList.remove('selected');
                        button.style.color = 'rgba(255, 255, 255, 0.6)';
                        textElement.classList.remove('expanded');
                    }
                });
                this.onChange(this.selected);
            }
            bindEvents() {
                if (this.eventsbound) return;
                this.eventsbound = true;
                this.container.addEventListener('click', (e) => {
                    const button = e.target.closest('.tab-button');
                    if (button && button.dataset.index !== undefined) {
                        this.handleSelect(parseInt(button.dataset.index));
                    }
                });
            }
        }
       
        function showContentSection(tabTitle) {
           
            const sections = document.querySelectorAll('.content-section');
            sections.forEach(section => {
                section.classList.remove('active');
            });
            
           
            let sectionId = '';
            switch(tabTitle) {
                case 'Add Blogs':
                    sectionId = 'addBlogs';
                    break;
                case 'Edit/Delete Blog':
                    sectionId = 'editBlogs';
                    break;
                // case 'Manage Images':
                //     sectionId = 'manageImages';
                    break;
            }
            
            if (sectionId) {
                const targetSection = document.getElementById(sectionId);
                if (targetSection) {
                    targetSection.classList.add('active');
                }
            }
        }
        
        // Labels functionality
        function initializeLabelsSection() {
            const addLabelBtn = document.getElementById('addLabelBtn');
            const labelsContainer = document.getElementById('labelsContainer');
            const labelsNotMandatory = document.getElementById('labelsNotMandatory');
            
            // Add label button functionality
            addLabelBtn.addEventListener('click', function() {
                addLabelRow();
            });
            
            // Remove label functionality using event delegation
            labelsContainer.addEventListener('click', function(e) {
                if (e.target.closest('.remove-label-btn')) {
                    const labelItem = e.target.closest('.label-item');
                    const allLabels = labelsContainer.querySelectorAll('.label-item');
                    
                    // Don't allow removing if only one label remains
                    if (allLabels.length > 1) {
                        labelItem.remove();
                    } else {
                        // Just clear the inputs instead of removing the row
                        labelItem.querySelector('.label-input').value = '';
                        labelItem.querySelector('.weight-input').value = '';
                    }
                }
            });
        }
        
        function addLabelRow() {
            const labelsContainer = document.getElementById('labelsContainer');
            const labelItem = document.createElement('div');
            labelItem.className = 'label-item flex items-center gap-3';
            labelItem.innerHTML = `
                <div class="flex-1">
                    <input type="text" class="label-input form-input" placeholder="Enter label name..." />
                </div>
                <div class="w-24">
                    <input type="number" class="weight-input form-input" placeholder="Weight" min="1" max="100" />
                </div>
                <button type="button" class="remove-label-btn text-white/50 hover:text-red-500 transition-colors p-2 rounded-lg hover:bg-white/[0.05]" title="Remove">
                    <i data-lucide="x" class="w-4 h-4"></i>
                </button>
            `;
            labelsContainer.appendChild(labelItem);
            lucide.createIcons();
        }
        
        function populateLabelsFromData(labelsData) {
            const labelsContainer = document.getElementById('labelsContainer');
            const labelsNotMandatory = document.getElementById('labelsNotMandatory');
            
            // Clear existing labels
            labelsContainer.innerHTML = '';
            
            // Check if labels data exists and is not empty
            if (labelsData && typeof labelsData === 'object' && Object.keys(labelsData).length > 0) {
                // Populate with existing labels
                Object.entries(labelsData).forEach(([label, weight]) => {
                    const labelItem = document.createElement('div');
                    labelItem.className = 'label-item flex items-center gap-3';
                    labelItem.innerHTML = `
                        <div class="flex-1">
                            <input type="text" class="label-input form-input" placeholder="Enter label name..." value="${label}" />
                        </div>
                        <div class="w-24">
                            <input type="number" class="weight-input form-input" placeholder="Weight" min="1" max="100" value="${weight}" />
                        </div>
                        <button type="button" class="remove-label-btn text-white/50 hover:text-red-500 transition-colors p-2 rounded-lg hover:bg-white/[0.05]" title="Remove">
                            <i data-lucide="x" class="w-4 h-4"></i>
                        </button>
                    `;
                    labelsContainer.appendChild(labelItem);
                });
                labelsNotMandatory.checked = false;
            } else {
                // Add default empty label row
                addLabelRow();
                labelsNotMandatory.checked = true;
            }
            
            lucide.createIcons();
        }
        
        function collectLabelsData() {
            const labelsNotMandatory = document.getElementById('labelsNotMandatory').checked;
            const labelItems = document.querySelectorAll('.label-item');
            const labelsObj = {};
            let hasLabels = false;
            
            labelItems.forEach(item => {
                const labelInput = item.querySelector('.label-input').value.trim();
                const weightInput = item.querySelector('.weight-input').value.trim();
                
                if (labelInput && weightInput) {
                    labelsObj[labelInput] = parseInt(weightInput);
                    hasLabels = true;
                }
            });
            
            // Check if labels are required but not provided
            if (!labelsNotMandatory && !hasLabels) {
                showModal('Labels Required', 'Please add at least one label or check the "Labels are not mandatory" option.', 'error');
                return null;
            }
            
            return { labels: labelsObj, labelsNotMandatory: labelsNotMandatory };
        }
        
       
        function handleFormSubmit(event) {
            event.preventDefault();
            
            // Validate and collect labels data first
            const labelsResult = collectLabelsData();
            if (labelsResult === null) {
                return; // Labels validation failed
            }
            
            const formData = new FormData(event.target);
            const data = {};
            for (let [key, value] of formData.entries()) {
                data[key] = value;
            }
            
            // Add labels data
            data.labels = labelsResult.labels;
            data.labelsNotMandatory = labelsResult.labelsNotMandatory;
            
           
            if (!data.blogDate) {
                const today = new Date().toISOString().split('T')[0];
                data.blogDate = today;
            }
            
            console.log('Form submitted:', data);
            alert('Blog added successfully! (This is a demo)');
            event.target.reset();
        }
        
       
        async function handleLoadPreview() {
            const form = document.getElementById('addBlogForm');
            const formData = new FormData(form);
            const data = {};
            for (let [key, value] of formData.entries()) {
               
                if (!key.startsWith('dynamic_')) {
                    data[key] = value;
                }
            }
            
           
            if (!data.blogDate) {
                const today = new Date().toISOString().split('T')[0];
                data.blogDate = today;
                document.getElementById('blogDate').value = today;
            }
            
           
            const dynamicSections = collectDynamicSections();
            data.dynamicSections = dynamicSections;
            
            try {
               
                const loadPreviewBtn = document.getElementById('loadPreviewBtn');
                const originalText = loadPreviewBtn.innerHTML;
                loadPreviewBtn.innerHTML = '<i data-lucide="loader-2" class="w-4 h-4 mr-2 animate-spin"></i>Loading...';
                loadPreviewBtn.disabled = true;
                
               
                const response = await fetch('/admin_blog_preview', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(data)
                });
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                const result = await response.json();
                
               
                loadPreviewBtn.innerHTML = originalText;
                loadPreviewBtn.disabled = false;
                
                if (result.status === 'success') {
                   
                    const previewWindow = window.open('', 'preview', 'width=800,height=600,scrollbars=yes');
                    previewWindow.document.write(result.data);
                    previewWindow.document.close();
                } else {
                    alert('Error generating preview: ' + (result.message || 'Unknown error'));
                }
                
            } catch (error) {
               
                const loadPreviewBtn = document.getElementById('loadPreviewBtn');
                loadPreviewBtn.innerHTML = '<i data-lucide="eye" class="w-4 h-4 mr-2"></i>Load Preview';
                loadPreviewBtn.disabled = false;
                
                console.error('Error loading preview:', error);
                alert('Error loading preview: ' + error.message);
            }
        }
        
       
        async function handleSaveDraft() {
            // Validate and collect labels data first
            const labelsResult = collectLabelsData();
            if (labelsResult === null) {
                return; // Labels validation failed
            }
            
            const form = document.getElementById('addBlogForm');
            const formData = new FormData(form);
            const data = {};
            for (let [key, value] of formData.entries()) {
               
                if (!key.startsWith('dynamic_')) {
                    data[key] = value;
                }
            }
            
            // Add labels data
            data.labels = labelsResult.labels;
            data.labelsNotMandatory = labelsResult.labelsNotMandatory;
            
           
            if (!data.blogDate) {
                const today = new Date().toISOString().split('T')[0];
                data.blogDate = today;
                document.getElementById('blogDate').value = today;
            }
            
           
            const dynamicSections = collectDynamicSections();
            data.dynamicSections = dynamicSections;
            
           
            data.status = 'draft';
            data.enc_email = localStorage.getItem('enc_email') || '';
            data.enc_pwd = localStorage.getItem('enc_pwd') || '';
            data.base_url = window.location.origin;
            
            try {
               
                const saveDraftBtn = document.getElementById('saveDraftBtn');
                const originalText = saveDraftBtn.innerHTML;
                saveDraftBtn.innerHTML = '<i data-lucide="loader-2" class="w-4 h-4 mr-2 animate-spin"></i>Saving...';
                saveDraftBtn.disabled = true;
                
               
                const response = await fetch('/admin_save_blog', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(data)
                });
                
               
                saveDraftBtn.innerHTML = originalText;
                saveDraftBtn.disabled = false;
                
                if (!response.ok) {
                   
                    let errorMessage = `Server error (${response.status})`;
                    try {
                        const errorResult = await response.json();
                        errorMessage = errorResult.message || errorResult.error || errorMessage;
                    } catch (e) {
                       
                        errorMessage = response.statusText || errorMessage;
                    }
                    showModal('Error Saving Draft', errorMessage, 'error');
                    return;
                }
                
                const result = await response.json();
                
                if (result.status === 'success') {
                    let message = 'Blog saved as draft successfully!';
                    if (result.url) {
                        message += `\n\nBlog URL: ${result.url}`;
                    }
                    showModal('Success', message, 'success');
                } else {
                    showModal('Error Saving Draft', result.message || 'Unknown error', 'error');
                }
                
            } catch (error) {
               
                const saveDraftBtn = document.getElementById('saveDraftBtn');
                saveDraftBtn.innerHTML = '<i data-lucide="file-text" class="w-4 h-4 mr-2"></i>Save as Draft';
                saveDraftBtn.disabled = false;
                
                console.error('Error saving draft:', error);
                showModal('Error Saving Draft', error.message, 'error');
            }
        }
        
       
        async function handleSavePublish() {
            // Validate and collect labels data first
            const labelsResult = collectLabelsData();
            if (labelsResult === null) {
                return; // Labels validation failed
            }
            
            const form = document.getElementById('addBlogForm');
            const formData = new FormData(form);
            const data = {};
            for (let [key, value] of formData.entries()) {
               
                if (!key.startsWith('dynamic_')) {
                    data[key] = value;
                }
            }
            
            // Add labels data
            data.labels = labelsResult.labels;
            data.labelsNotMandatory = labelsResult.labelsNotMandatory;
            
           
            if (!data.blogDate) {
                const today = new Date().toISOString().split('T')[0];
                data.blogDate = today;
                document.getElementById('blogDate').value = today;
            }
            
           
            const dynamicSections = collectDynamicSections();
            data.dynamicSections = dynamicSections;
            
           
            data.status = 'published';
            data.enc_email = localStorage.getItem('enc_email') || '';
            data.enc_pwd = localStorage.getItem('enc_pwd') || '';
            data.base_url = window.location.origin;
            
            try {
               
                const savePublishBtn = document.getElementById('savePublishBtn');
                const originalText = savePublishBtn.innerHTML;
                savePublishBtn.innerHTML = '<i data-lucide="loader-2" class="w-4 h-4 mr-2 animate-spin"></i>Publishing...';
                savePublishBtn.disabled = true;
                
               
                const response = await fetch('/admin_save_blog', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(data)
                });
                
               
                savePublishBtn.innerHTML = originalText;
                savePublishBtn.disabled = false;
                
                if (!response.ok) {
                   
                    let errorMessage = `Server error (${response.status})`;
                    try {
                        const errorResult = await response.json();
                        errorMessage = errorResult.message || errorResult.error || errorMessage;
                    } catch (e) {
                       
                        errorMessage = response.statusText || errorMessage;
                    }
                    showModal('Error Publishing Blog', errorMessage, 'error');
                    return;
                }
                
                const result = await response.json();
                
                if (result.status === 'success') {
                    let message = 'Blog published successfully!';
                    if (result.url) {
                        message += `\n\nBlog URL: ${result.url}`;
                    }
                    showModal('Success', message, 'success');
                   
                    form.reset();
                   
                    document.getElementById('dynamicSections').innerHTML = '';
                    sectionCounter = 0;
                } else {
                    showModal('Error Publishing Blog', result.message || 'Unknown error', 'error');
                }
                
            } catch (error) {
               
                const savePublishBtn = document.getElementById('savePublishBtn');
                savePublishBtn.innerHTML = '<i data-lucide="send" class="w-4 h-4 mr-2"></i>Save & Publish';
                savePublishBtn.disabled = false;
                
                console.error('Error publishing blog:', error);
                showModal('Error Publishing Blog', error.message, 'error');
            }
        }
        
       
        let sectionCounter = 0;
        
        function createDynamicSection(type, content = '') {
            sectionCounter++;
            const sectionId = `section_${sectionCounter}`;
            const sectionDiv = document.createElement('div');
            sectionDiv.className = 'dynamic-section p-4 rounded-lg  relative';
            sectionDiv.dataset.sectionId = sectionId;
            sectionDiv.dataset.sectionType = type;
            
            let sectionHTML = '';
            
            switch(type) {
                case 'text':
                    sectionHTML = `
                        <div class="flex justify-between items-center mb-2">
                            <label class="form-label text-sm flex items-center">
                                <i data-lucide="type" class="w-4 h-4 mr-2"></i>Text Content
                            </label>
                            <button type="button" class="remove-section" data-section-id="${sectionId}">
                                <i data-lucide="x" class="w-4 h-4"></i>
                            </button>
                        </div>
                        <div class="text-formatting-toolbar mb-2 flex flex-wrap gap-1">
                            <button type="button" class="format-btn" data-format="bold" title="Bold"><i data-lucide="bold" class="w-4 h-4"></i></button>
                            <button type="button" class="format-btn" data-format="italic" title="Italic"><i data-lucide="italic" class="w-4 h-4"></i></button>
                            <button type="button" class="format-btn" data-format="underline" title="Underline"><i data-lucide="underline" class="w-4 h-4"></i></button>
                            <button type="button" class="format-btn" data-format="link" title="Hyperlink"><i data-lucide="link" class="w-4 h-4"></i></button>
                            <button type="button" class="format-btn" data-format="list" title="Bullet Points"><i data-lucide="list" class="w-4 h-4"></i></button>
                        </div>
                        <textarea name="dynamic_text_${sectionId}" class="form-input" style="height: 4rem; resize: vertical;" placeholder="Enter your text content...">${content}</textarea>
                    `;
                    break;
                case 'h1':
                    sectionHTML = `
                        <div class="flex justify-between items-center mb-2">
                            <label class="form-label text-sm flex items-center">
                                <i data-lucide="heading-1" class="w-4 h-4 mr-2"></i>H1 Header
                            </label>
                            <button type="button" class="remove-section" data-section-id="${sectionId}">
                                <i data-lucide="x" class="w-4 h-4"></i>
                            </button>
                        </div>
                        <div class="text-formatting-toolbar mb-2 flex flex-wrap gap-1">
                            <button type="button" class="format-btn" data-format="bold" title="Bold"><i data-lucide="bold" class="w-4 h-4"></i></button>
                            <button type="button" class="format-btn" data-format="italic" title="Italic"><i data-lucide="italic" class="w-4 h-4"></i></button>
                            <button type="button" class="format-btn" data-format="underline" title="Underline"><i data-lucide="underline" class="w-4 h-4"></i></button>
                        </div>
                        <input type="text" name="dynamic_h1_${sectionId}" class="form-input" placeholder="Enter H1 header text..." value="${content}">
                    `;
                    break;
                case 'h2':
                    sectionHTML = `
                        <div class="flex justify-between items-center mb-2">
                            <label class="form-label text-sm flex items-center">
                                <i data-lucide="heading-2" class="w-4 h-4 mr-2"></i>H2 Header
                            </label>
                            <button type="button" class="remove-section" data-section-id="${sectionId}">
                                <i data-lucide="x" class="w-4 h-4"></i>
                            </button>
                        </div>
                        <div class="text-formatting-toolbar mb-2 flex flex-wrap gap-1">
                            <button type="button" class="format-btn" data-format="bold" title="Bold"><i data-lucide="bold" class="w-4 h-4"></i></button>
                            <button type="button" class="format-btn" data-format="italic" title="Italic"><i data-lucide="italic" class="w-4 h-4"></i></button>
                            <button type="button" class="format-btn" data-format="underline" title="Underline"><i data-lucide="underline" class="w-4 h-4"></i></button>
                        </div>
                        <input type="text" name="dynamic_h2_${sectionId}" class="form-input" placeholder="Enter H2 header text..." value="${content}">
                    `;
                    break;
                case 'h3':
                    sectionHTML = `
                        <div class="flex justify-between items-center mb-2">
                            <label class="form-label text-sm flex items-center">
                                <i data-lucide="heading-3" class="w-4 h-4 mr-2"></i>H3 Header
                            </label>
                            <button type="button" class="remove-section" data-section-id="${sectionId}">
                                <i data-lucide="x" class="w-4 h-4"></i>
                            </button>
                        </div>
                        <div class="text-formatting-toolbar mb-2 flex flex-wrap gap-1">
                            <button type="button" class="format-btn" data-format="bold" title="Bold"><i data-lucide="bold" class="w-4 h-4"></i></button>
                            <button type="button" class="format-btn" data-format="italic" title="Italic"><i data-lucide="italic" class="w-4 h-4"></i></button>
                            <button type="button" class="format-btn" data-format="underline" title="Underline"><i data-lucide="underline" class="w-4 h-4"></i></button>
                        </div>
                        <input type="text" name="dynamic_h3_${sectionId}" class="form-input" placeholder="Enter H3 header text..." value="${content}">
                    `;
                    break;
                case 'h4':
                    sectionHTML = `
                        <div class="flex justify-between items-center mb-2">
                            <label class="form-label text-sm flex items-center">
                                <i data-lucide="heading-4" class="w-4 h-4 mr-2"></i>H4 Header
                            </label>
                            <button type="button" class="remove-section" data-section-id="${sectionId}">
                                <i data-lucide="x" class="w-4 h-4"></i>
                            </button>
                        </div>
                        <div class="text-formatting-toolbar mb-2 flex flex-wrap gap-1">
                            <button type="button" class="format-btn" data-format="bold" title="Bold"><i data-lucide="bold" class="w-4 h-4"></i></button>
                            <button type="button" class="format-btn" data-format="italic" title="Italic"><i data-lucide="italic" class="w-4 h-4"></i></button>
                            <button type="button" class="format-btn" data-format="underline" title="Underline"><i data-lucide="underline" class="w-4 h-4"></i></button>
                        </div>
                        <input type="text" name="dynamic_h4_${sectionId}" class="form-input" placeholder="Enter H4 header text..." value="${content}">
                    `;
                    break;
                case 'h5':
                    sectionHTML = `
                        <div class="flex justify-between items-center mb-2">
                            <label class="form-label text-sm flex items-center">
                                <i data-lucide="heading-5" class="w-4 h-4 mr-2"></i>H5 Header
                            </label>
                            <button type="button" class="remove-section" data-section-id="${sectionId}">
                                <i data-lucide="x" class="w-4 h-4"></i>
                            </button>
                        </div>
                        <div class="text-formatting-toolbar mb-2 flex flex-wrap gap-1">
                            <button type="button" class="format-btn" data-format="bold" title="Bold"><i data-lucide="bold" class="w-4 h-4"></i></button>
                            <button type="button" class="format-btn" data-format="italic" title="Italic"><i data-lucide="italic" class="w-4 h-4"></i></button>
                            <button type="button" class="format-btn" data-format="underline" title="Underline"><i data-lucide="underline" class="w-4 h-4"></i></button>
                        </div>
                        <input type="text" name="dynamic_h5_${sectionId}" class="form-input" placeholder="Enter H5 header text..." value="${content}">
                    `;
                    break;
                case 'h6':
                    sectionHTML = `
                        <div class="flex justify-between items-center mb-2">
                            <label class="form-label text-sm flex items-center">
                                <i data-lucide="heading-6" class="w-4 h-4 mr-2"></i>H6 Header
                            </label>
                            <button type="button" class="remove-section" data-section-id="${sectionId}">
                                <i data-lucide="x" class="w-4 h-4"></i>
                            </button>
                        </div>
                        <div class="text-formatting-toolbar mb-2 flex flex-wrap gap-1">
                            <button type="button" class="format-btn" data-format="bold" title="Bold"><i data-lucide="bold" class="w-4 h-4"></i></button>
                            <button type="button" class="format-btn" data-format="italic" title="Italic"><i data-lucide="italic" class="w-4 h-4"></i></button>
                            <button type="button" class="format-btn" data-format="underline" title="Underline"><i data-lucide="underline" class="w-4 h-4"></i></button>
                        </div>
                        <input type="text" name="dynamic_h6_${sectionId}" class="form-input" placeholder="Enter H6 header text..." value="${content}">
                    `;
                    break;
                case 'subheader-text':
                    sectionHTML = `
                        <div class="flex justify-between items-center mb-2">
                            <label class="form-label text-sm flex items-center">
                                <i data-lucide="heading-3" class="w-4 h-4 mr-2"></i>Subheader Text
                            </label>
                            <button type="button" class="remove-section" data-section-id="${sectionId}">
                                <i data-lucide="x" class="w-4 h-4"></i>
                            </button>
                        </div>
                        <textarea name="dynamic_subheader_text_${sectionId}" class="form-input" style="height: 3rem; resize: vertical;" placeholder="Enter subheader text content...">${content}</textarea>
                    `;
                    break;
                case 'image':
                    sectionHTML = `
                        <div class="flex justify-between items-center mb-2">
                            <label class="form-label text-sm flex items-center">
                                <i data-lucide="image" class="w-4 h-4 mr-2"></i>Image + Alt Text
                            </label>
                            <button type="button" class="remove-section" data-section-id="${sectionId}">
                                <i data-lucide="x" class="w-4 h-4"></i>
                            </button>
                        </div>
                        <div class="space-y-2">
                            <input type="url" name="dynamic_image_url_${sectionId}" class="form-input" placeholder="Image URL..." value="${content.url || ''}">
                            <input type="text" name="dynamic_image_alt_${sectionId}" class="form-input" placeholder="Alt text for image..." value="${content.alt || ''}">
                        </div>
                    `;
                    break;
            }
            
            sectionDiv.innerHTML = sectionHTML;
            return sectionDiv;
        }
        
        function addDynamicSection(type) {
            const container = document.getElementById('dynamicSections');
            const section = createDynamicSection(type);
            container.appendChild(section);
            
           
            lucide.createIcons();
            
           
            const removeBtn = section.querySelector('.remove-section');
            removeBtn.addEventListener('click', function() {
                section.remove();
                updatePreviewIfVisible();
            });
            
           
            const inputs = section.querySelectorAll('input, textarea');
            inputs.forEach(input => {
                input.addEventListener('input', updatePreviewIfVisible);
            });
            
            // Add formatting toolbar functionality
            const formatBtns = section.querySelectorAll('.format-btn');
            formatBtns.forEach(btn => {
                btn.addEventListener('click', function(e) {
                    e.preventDefault();
                    const format = this.dataset.format;
                    const textInput = section.querySelector('input[type="text"], textarea');
                    
                    if (textInput) {
                        applyFormatting(textInput, format);
                    }
                });
            });
            
           
            setTimeout(() => {
                section.scrollIntoView({
                    behavior: 'smooth',
                    block: 'center'
                });
            }, 100);
            
            updatePreviewIfVisible();
        }
        
        function applyFormatting(textInput, format) {
            const start = textInput.selectionStart;
            const end = textInput.selectionEnd;
            const selectedText = textInput.value.substring(start, end);
            const beforeText = textInput.value.substring(0, start);
            const afterText = textInput.value.substring(end);
            
            let formattedText = '';
            
            switch(format) {
                case 'bold':
                    formattedText = selectedText ? `<strong>${selectedText}</strong>` : '<strong></strong>';
                    break;
                case 'italic':
                    formattedText = selectedText ? `<em>${selectedText}</em>` : '<em></em>';
                    break;
                case 'underline':
                    formattedText = selectedText ? `<u>${selectedText}</u>` : '<u></u>';
                    break;
                case 'link':
                    showLinkDialog(textInput, selectedText, beforeText, afterText, start);
                    return; // Return early as showLinkDialog handles the text insertion
                    break;
                case 'list':
                    showBulletDialog(textInput, selectedText, beforeText, afterText, start);
                    return; // Return early as showBulletDialog handles the text insertion
                    break;
                default:
                    return;
            }
            
            textInput.value = beforeText + formattedText + afterText;
            
            // Set cursor position after the inserted text
            const newCursorPos = start + formattedText.length;
            textInput.setSelectionRange(newCursorPos, newCursorPos);
            textInput.focus();
        }
        
        function updatePreviewIfVisible() {
           
           
        }
        
        function collectDynamicSections() {
            const sections = [];
            const dynamicSections = document.querySelectorAll('.dynamic-section');
            
            dynamicSections.forEach(section => {
                const type = section.dataset.sectionType;
                const sectionId = section.dataset.sectionId;
                
                let sectionData = { type, id: sectionId };
                
                switch(type) {
                    case 'text':
                        sectionData.content = section.querySelector(`[name="dynamic_text_${sectionId}"]`).value;
                        break;
                    case 'h1':
                        sectionData.content = section.querySelector(`[name="dynamic_h1_${sectionId}"]`).value;
                        break;
                    case 'h2':
                        sectionData.content = section.querySelector(`[name="dynamic_h2_${sectionId}"]`).value;
                        break;
                    case 'h3':
                        sectionData.content = section.querySelector(`[name="dynamic_h3_${sectionId}"]`).value;
                        break;
                    case 'h4':
                        sectionData.content = section.querySelector(`[name="dynamic_h4_${sectionId}"]`).value;
                        break;
                    case 'h5':
                        sectionData.content = section.querySelector(`[name="dynamic_h5_${sectionId}"]`).value;
                        break;
                    case 'h6':
                        sectionData.content = section.querySelector(`[name="dynamic_h6_${sectionId}"]`).value;
                        break;
                    case 'header':
                        sectionData.content = section.querySelector(`[name="dynamic_header_${sectionId}"]`).value;
                        break;
                    case 'subheader':
                        sectionData.content = section.querySelector(`[name="dynamic_subheader_${sectionId}"]`).value;
                        break;
                    case 'subheader-text':
                        sectionData.content = section.querySelector(`[name="dynamic_subheader_text_${sectionId}"]`).value;
                        break;
                    case 'image':
                        sectionData.content = {
                            url: section.querySelector(`[name="dynamic_image_url_${sectionId}"]`).value,
                            alt: section.querySelector(`[name="dynamic_image_alt_${sectionId}"]`).value
                        };
                        break;
                }
                
                sections.push(sectionData);
            });
            
            return sections;
        }
        
        // Blog management variables
        let currentPage = 1;
        let totalPages = 1;
        let searchTimeout = null;
        const blogsPerPage = 8;
        let allFetchedBlogs = [];

        async function fetchBlogs() {
            const blogsLoading = document.getElementById('blogsLoading');
            const noBlogsFound = document.getElementById('noBlogsFound');
            const blogsList = document.getElementById('blogsList');
            const paginationControls = document.getElementById('paginationControls');
        
            blogsLoading.classList.remove('hidden');
            noBlogsFound.classList.add('hidden');
            blogsList.innerHTML = '';
            paginationControls.classList.add('hidden');
        
            try {
                const response = await fetch('/get_blog_list');
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                const result = await response.json();
                blogsLoading.classList.add('hidden');
                if (result.status === 'success' && result.blogs) {
                    allFetchedBlogs = result.blogs;
                    applyFiltersAndRender(1);
                } else {
                    allFetchedBlogs = [];
                    applyFiltersAndRender(1);
                }
            } catch (error) {
                console.error('Error fetching blogs:', error);
                blogsLoading.classList.add('hidden');
                blogsList.innerHTML = `<div class="text-center py-8"><p class="text-white/60">Error loading blogs. Please try again later.</p></div>`;
            }
        }

        function applyFiltersAndRender(page = 1) {
            const filterTitleValue = document.getElementById('filterTitle').value.trim().toLowerCase();
            const filterAuthorValue = document.getElementById('filterAuthor').value.trim().toLowerCase();
            const filterCategoryValue = document.getElementById('filterCategory').value;
            const filterKeywordsValue = document.getElementById('filterKeywords').value.trim().toLowerCase();
        
            const filteredBlogs = allFetchedBlogs.filter(blog => {
                const jsonData = blog.json_data || {};
                const title = (jsonData.blogTitle || '').toLowerCase();
                const author = (jsonData.blogAuthor || '').toLowerCase();
                const category = blog.category || jsonData.blogCategory || '';
                const labels = blog.labels ? Object.keys(blog.labels).map(k => k.toLowerCase()) : [];

                const titleMatch = !filterTitleValue || title.includes(filterTitleValue);
                const authorMatch = !filterAuthorValue || author.includes(filterAuthorValue);
                const categoryMatch = filterCategoryValue === 'ALL' || category === filterCategoryValue;
                const keywordsMatch = !filterKeywordsValue || labels.some(label => label.includes(filterKeywordsValue));
        
                return titleMatch && authorMatch && categoryMatch && keywordsMatch;
            });
        
            const noBlogsFound = document.getElementById('noBlogsFound');
            const blogsList = document.getElementById('blogsList');
            const paginationControls = document.getElementById('paginationControls');
        
            if (filteredBlogs.length > 0) {
                noBlogsFound.classList.add('hidden');
                blogsList.classList.remove('hidden');
                
                totalPages = Math.ceil(filteredBlogs.length / blogsPerPage);
                currentPage = page;
                const startIndex = (page - 1) * blogsPerPage;
                const endIndex = startIndex + blogsPerPage;
                const paginatedBlogs = filteredBlogs.slice(startIndex, endIndex);
                
                displayBlogs(paginatedBlogs);
                
                if (totalPages > 1) {
                    updatePaginationControls();
                    paginationControls.classList.remove('hidden');
                } else {
                    paginationControls.classList.add('hidden');
                }
            } else {
                blogsList.innerHTML = '';
                blogsList.classList.add('hidden');
                noBlogsFound.classList.remove('hidden');
                paginationControls.classList.add('hidden');
            }
        }
        
        // Display blogs function
        function displayBlogs(blogs) {
            const blogsList = document.getElementById('blogsList');
            
            blogsList.innerHTML = blogs.map(blog => {
                // Extract data from the nested json_data structure
                const jsonData = blog.json_data || {};
                const title = jsonData.blogTitle || 'Untitled';
                const author = jsonData.blogAuthor || 'Unknown';
                const date = jsonData.blogDate || blog.created_at;
                const status = blog.status || 'draft';
                const mainImageUrl = jsonData.mainImageUrl || '';
                const mainImageAlt = jsonData.mainImageAlt || '';
                const category = blog.category || jsonData.blogCategory || '';
                // Sub-category commented out as requested
                // const subCategory = blog.sub_category || jsonData.blogSubCategory || '';
                
                return `
                    <div class="p-4 bg-white/5 rounded-lg border border-white/10 hover:bg-white/10 transition-colors">
                        <div class="flex justify-between items-start mb-3">
                            <div class="flex-1">
                                <h3 class="font-semibold mb-2 text-white line-clamp-2">${escapeHtml(title)}</h3>
                                ${category ? `
                                    <p class="text-xs text-white/50 mb-2 flex items-center gap-2">
                                        <i data-lucide="tag" class="w-3 h-3"></i>
                                        <span>${escapeHtml(category)}</span>
                                    </p>
                                ` : ''}
                                <p class="text-sm text-white/60 mb-2 flex items-center gap-2 flex-wrap">
                                    <span class="flex items-center gap-1">
                                        <i data-lucide="user" class="w-3 h-3"></i>
                                        <span>By ${escapeHtml(author)}</span>
                                    </span>
                                    <span></span>
                                    <span class="flex items-center gap-1">
                                        <i data-lucide="calendar" class="w-3 h-3"></i>
                                        <span>${formatDate(date)}</span>
                                    </span>
                                    <span></span>
                                    <span class="px-2 py-1 rounded-full text-xs ${status === 'published' ? 'bg-green-600/20 text-green-400' : 'bg-yellow-600/20 text-yellow-400'}">${status}</span>
                                </p>
                            </div>
                            ${mainImageUrl ? `
                                <div class="ml-4 flex-shrink-0">
                                    <img src="${escapeHtml(mainImageUrl)}" alt="${escapeHtml(mainImageAlt)}"
                                         class="w-16 h-16 object-cover rounded-lg border border-white/10">
                                </div>
                            ` : ''}
                        </div>
                        <div class="flex gap-2 flex-wrap">
                            <button class="form-button text-xs px-4 py-2 min-w-[70px] bg-white/10 hover:bg-white/20 border border-white/20 text-white" onclick="editBlog('${blog.id.replace("'","[quotetation_here]")}')">
                                <div class="flex items-center gap-2">
                                    <i data-lucide="edit" class="w-3 h-3"></i>
                                    <p>Edit</p>
                                </div>
                            </button>
                            <button class="form-button text-xs px-4 py-2 min-w-[60px] bg-white/10 hover:bg-white/20 border border-white/20 text-white" onclick="showBlogUrl('${blog.id.replace("'","[quotetation_here]")}', '${title.replace("'", "[quotetation_here]")}')">
                                <div class="flex items-center gap-2">
                                    <i data-lucide="external-link" class="w-3 h-3"></i>
                                    <p>URL</p>
                                </div>
                            </button>
                            <button class="form-button text-xs px-4 py-2 min-w-[75px] bg-red-600 hover:bg-red-700 text-white" onclick="deleteBlog('${blog.id.replace("'","[quotetation_here]")}', '${title.replace("'", "[quotetation_here]")}')">
                                <div class="flex items-center gap-2">
                                    <i data-lucide="trash-2" class="w-3 h-3"></i>
                                    <p>Delete</p>
                                </div>
                            </button>
                        </div>
                    </div>
                `;
            }).join('');
            
            lucide.createIcons();
        }
        
        // Update pagination controls
        function updatePaginationControls() {
            const prevBtn = document.getElementById('prevPage');
            const nextBtn = document.getElementById('nextPage');
            const pageInfo = document.getElementById('pageInfo');
            
            if (prevBtn) {
                prevBtn.disabled = currentPage <= 1;
            }
            if (nextBtn) {
                nextBtn.disabled = currentPage >= totalPages;
            }
            if (pageInfo) {
                pageInfo.textContent = `Page ${currentPage} of ${totalPages}`;
            }
        }
        
        // Utility functions
        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }
        
        function formatDate(dateString) {
            if (!dateString) return 'No date';
            try {
                const date = new Date(dateString);
                return date.toLocaleDateString('en-US', {
                    year: 'numeric',
                    month: 'short',
                    day: 'numeric'
                });
            } catch (e) {
                return dateString;
            }
        }
        
        // Global variable to track current editing blog
        let currentEditingBlog = null;
        let isEditing = false;
        
        // Blog action functions
        async function editBlog(blogId) {
            blogId = blogId.replace("[quotetation_here]", "'");
            if (!blogId) {
                showModal('Error', 'Blog ID not found', 'error');
                return;
            }
            
            const blog = allFetchedBlogs.find(b => b.id === blogId);
            if (blog) {
                isEditing = true;
                populateEditForm(blog);
                switchToEditMode();
                // Switch to Add Blogs tab to show the form
                const addBlogsTab = Array.from(document.querySelectorAll('#navbarTabs .tab-button')).find(btn => btn.textContent.includes('Add Blogs'));
                if (addBlogsTab) {
                    addBlogsTab.click();
                }
                isEditing = false;
            } else {
                showModal('Error', 'Blog not found in the list. Please refresh.', 'error');
            }
        }
        
        function populateEditForm(blog) {
            currentEditingBlog = blog;
            const jsonData = blog.json_data || {};
            
            // Populate basic fields
            document.getElementById('mainImageUrl').value = jsonData.mainImageUrl || '';
            document.getElementById('mainImageAlt').value = jsonData.mainImageAlt || '';
            document.getElementById('blogTitle').value = jsonData.blogTitle || '';
            document.getElementById('blogAuthor').value = jsonData.blogAuthor || '';
            document.getElementById('blogDate').value = jsonData.blogDate || '';
            document.getElementById('blogSummary').value = jsonData.blogSummary || '';
            
            // Set status radio button
            const statusRadios = document.querySelectorAll('input[name="blogStatus"]');
            statusRadios.forEach(radio => {
                radio.checked = radio.value === blog.status;
            });
            
            // Populate category fields
            document.getElementById('blogCategory').value = jsonData.blogCategory || '';
            // Sub-category commented out as requested
            // document.getElementById('blogSubCategory').value = jsonData.blogSubCategory || '';
            
            // Populate labels from database
            populateLabelsFromData(blog.labels || {});
            
            // Populate SEO fields
            document.getElementById('seoTitle').value = jsonData.seoTitle || '';
            document.getElementById('seoMetaDescription').value = jsonData.seoMetaDescription || '';
            document.getElementById('seoCanonicalUrl').value = jsonData.seoCanonicalUrl || '';
            
            // Populate ad banners
            document.querySelector('input[name="adBannerBesideUrl"]').value = jsonData.adBannerBesideUrl || '';
            document.querySelector('input[name="adBannerBesideHref"]').value = jsonData.adBannerBesideHref || '';
            document.querySelector('input[name="adBannerBelowUrl"]').value = jsonData.adBannerBelowUrl || '';
            document.querySelector('input[name="adBannerBelowHref"]').value = jsonData.adBannerBelowHref || '';
            
            // Clear existing dynamic sections
            document.getElementById('dynamicSections').innerHTML = '';
            sectionCounter = 0;
            
            // Populate dynamic sections
            if (jsonData.dynamicSections && Array.isArray(jsonData.dynamicSections)) {
                jsonData.dynamicSections.forEach(section => {
                    const sectionElement = createDynamicSection(section.type, section.content);
                    document.getElementById('dynamicSections').appendChild(sectionElement);
                    
                    // Add event listeners for remove buttons
                    const removeBtn = sectionElement.querySelector('.remove-section');
                    removeBtn.addEventListener('click', function() {
                        sectionElement.remove();
                    });
                });
            }
            
            lucide.createIcons();
        }
        
        function switchToEditMode() {
            // Update form title
            document.querySelector('#addBlogs .section-title').textContent = 'Edit Blog';
            
            // Show status section
            document.getElementById('blogStatusSection').style.display = 'block';
            
            // Hide add mode buttons, show edit mode buttons
            document.getElementById('addModeButtons').style.display = 'none';
            document.getElementById('editModeButtons').style.display = 'flex';
        }
        
        function switchToAddMode() {
            // Reset form title
            document.querySelector('#addBlogs .section-title').textContent = 'Add New Blog';
            
            // Hide status section
            document.getElementById('blogStatusSection').style.display = 'none';
            
            // Show add mode buttons, hide edit mode buttons
            document.getElementById('addModeButtons').style.display = 'flex';
            document.getElementById('editModeButtons').style.display = 'none';
            
            // Clear current editing blog
            currentEditingBlog = null;
            
            // Reset form
            document.getElementById('addBlogForm').reset();
            document.getElementById('dynamicSections').innerHTML = '';
            sectionCounter = 0;
            
            // Clear category and SEO fields explicitly
            document.getElementById('blogCategory').value = '';
            // Sub-category commented out as requested
            // document.getElementById('blogSubCategory').value = '';
            document.getElementById('seoTitle').value = '';
            document.getElementById('seoMetaDescription').value = '';
            document.getElementById('seoCanonicalUrl').value = '';
            
            // Reset labels section to default state
            const labelsContainer = document.getElementById('labelsContainer');
            labelsContainer.innerHTML = `
                <div class="label-item flex items-center gap-3">
                    <div class="flex-1">
                        <input type="text" class="label-input form-input" placeholder="Enter label name..." />
                    </div>
                    <div class="w-24">
                        <input type="number" class="weight-input form-input" placeholder="Weight" min="1" max="100" />
                    </div>
                    <button type="button" class="remove-label-btn text-white/50 hover:text-red-500 transition-colors p-2 rounded-lg hover:bg-white/[0.05]" title="Remove">
                        <i data-lucide="x" class="w-4 h-4"></i>
                    </button>
                </div>
            `;
            document.getElementById('labelsNotMandatory').checked = false;
            lucide.createIcons();
        }
        
        // Handle update blog functionality
        async function handleUpdateBlog() {
            if (!currentEditingBlog) {
                showModal('Error', 'No blog selected for editing', 'error');
                return;
            }
            
            // Validate and collect labels data first
            const labelsResult = collectLabelsData();
            if (labelsResult === null) {
                return; // Labels validation failed
            }
            
            const form = document.getElementById('addBlogForm');
            const formData = new FormData(form);
            const data = {};
            for (let [key, value] of formData.entries()) {
                if (!key.startsWith('dynamic_')) {
                    data[key] = value;
                }
            }
            
            // Add labels data
            data.labels = labelsResult.labels;
            data.labelsNotMandatory = labelsResult.labelsNotMandatory;
            
            // Get status from radio buttons
            const statusRadio = document.querySelector('input[name="blogStatus"]:checked');
            data.status = statusRadio ? statusRadio.value : 'draft';
            
            // Set blog date if not provided
            if (!data.blogDate) {
                const today = new Date().toISOString().split('T')[0];
                data.blogDate = today;
                document.getElementById('blogDate').value = today;
            }
            
            // Collect dynamic sections
            const dynamicSections = collectDynamicSections();
            data.dynamicSections = dynamicSections;
            
            // Add blog ID for update
            data.blog_id = currentEditingBlog.id;
            data.enc_email = localStorage.getItem('enc_email') || '';
            data.enc_pwd = localStorage.getItem('enc_pwd') || '';
            data.base_url = window.location.origin;
            data.reason = 'update';
            
            try {
                const updateBlogBtn = document.getElementById('updateBlogBtn');
                const originalText = updateBlogBtn.innerHTML;
                updateBlogBtn.innerHTML = '<i data-lucide="loader-2" class="w-4 h-4 mr-2 animate-spin"></i>Updating...';
                updateBlogBtn.disabled = true;
                
                // TODO: Replace with actual update endpoint when available
                const response = await fetch('/admin_save_blog', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(data)
                });
                
                updateBlogBtn.innerHTML = originalText;
                updateBlogBtn.disabled = false;
                
                if (!response.ok) {
                    let errorMessage = `Server error (${response.status})`;
                    try {
                        const errorResult = await response.json();
                        errorMessage = errorResult.message || errorResult.error || errorMessage;
                    } catch (e) {
                        errorMessage = response.statusText || errorMessage;
                    }
                    showModal('Error Updating Blog', errorMessage, 'error');
                    return;
                }
                
                const result = await response.json();
                
                if (result.status === 'success') {
                    let message = 'Blog updated successfully!';
                    if (result.url) {
                        message += `\n\nBlog URL: ${result.url}`;
                    }
                    showModal('Success', message, 'success');
                    
                    // Switch back to add mode and refresh blog list
                    switchToAddMode();
                    showContentSection('Edit/Delete Blog');
                } else {
                    showModal('Error Updating Blog', result.message || 'Unknown error', 'error');
                }
                
            } catch (error) {
                const updateBlogBtn = document.getElementById('updateBlogBtn');
                updateBlogBtn.innerHTML = '<i data-lucide="save" class="w-4 h-4 mr-2"></i>Update Blog';
                updateBlogBtn.disabled = false;
                
                console.error('Error updating blog:', error);
                showModal('Error Updating Blog', error.message, 'error');
            }
        }
        
        function deleteBlog(blogId, blogTitle) {
            blogId = blogId.replace("[quotetation_here]", "'");
            blogTitle = blogTitle.replace("[quotetation_here]", "'");
            if (!blogId) {
                showModal('Error', 'Blog ID not found', 'error');
                return;
            }
            
            // Show the delete confirmation modal instead of simple confirm dialog
            showDeleteConfirmModal(blogId, blogTitle);
        }
        
        document.addEventListener('DOMContentLoaded', function() {
            lucide.createIcons();
            
            // Initialize labels functionality
            initializeLabelsSection();
            
           
            const addBlogForm = document.getElementById('addBlogForm');
            if (addBlogForm) {
                addBlogForm.addEventListener('submit', handleFormSubmit);
            }
            
           
            const loadPreviewBtn = document.getElementById('loadPreviewBtn');
            if (loadPreviewBtn) {
                loadPreviewBtn.addEventListener('click', handleLoadPreview);
            }
            
           
            const saveDraftBtn = document.getElementById('saveDraftBtn');
            if (saveDraftBtn) {
                saveDraftBtn.addEventListener('click', handleSaveDraft);
            }
            
           
            const savePublishBtn = document.getElementById('savePublishBtn');
            if (savePublishBtn) {
                savePublishBtn.addEventListener('click', handleSavePublish);
            }
            
            // Edit mode button event listeners
            const loadPreviewEditBtn = document.getElementById('loadPreviewEditBtn');
            if (loadPreviewEditBtn) {
                loadPreviewEditBtn.addEventListener('click', handleLoadPreview);
            }
            
            const deleteBlogBtn = document.getElementById('deleteBlogBtn');
            if (deleteBlogBtn) {
                deleteBlogBtn.addEventListener('click', function() {
                    if (currentEditingBlog) {
                        const title = currentEditingBlog.json_data?.blogTitle || 'Untitled';
                        deleteBlog(currentEditingBlog.id, title);
                    }
                });
            }
            
            const updateBlogBtn = document.getElementById('updateBlogBtn');
            if (updateBlogBtn) {
                updateBlogBtn.addEventListener('click', handleUpdateBlog);
            }
            
           
            document.getElementById('addTextBtn').addEventListener('click', () => addDynamicSection('text'));
            document.getElementById('addH1Btn').addEventListener('click', () => addDynamicSection('h1'));
            document.getElementById('addH2Btn').addEventListener('click', () => addDynamicSection('h2'));
            document.getElementById('addH3Btn').addEventListener('click', () => addDynamicSection('h3'));
            document.getElementById('addH4Btn').addEventListener('click', () => addDynamicSection('h4'));
            document.getElementById('addH5Btn').addEventListener('click', () => addDynamicSection('h5'));
            document.getElementById('addH6Btn').addEventListener('click', () => addDynamicSection('h6'));
            document.getElementById('addImageBtn').addEventListener('click', () => addDynamicSection('image'));
            
            // Filter functionality for Edit/Delete section
            const filterTitleInput = document.getElementById('filterTitle');
            const filterAuthorInput = document.getElementById('filterAuthor');
            const filterCategoryInput = document.getElementById('filterCategory');
            const filterKeywordsInput = document.getElementById('filterKeywords');

            function setupFilterListeners() {
                const applyFilters = () => applyFiltersAndRender(1);
                
                const debounce = (func, delay) => {
                    clearTimeout(searchTimeout);
                    searchTimeout = setTimeout(func, delay);
                };

                filterTitleInput.addEventListener('input', () => debounce(applyFilters, 300));
                filterAuthorInput.addEventListener('input', () => debounce(applyFilters, 300));
                filterCategoryInput.addEventListener('change', applyFilters);
                filterKeywordsInput.addEventListener('input', () => debounce(applyFilters, 300));
            }
            
            setupFilterListeners();
            
            // Pagination event listeners
            const prevPage = document.getElementById('prevPage');
            const nextPage = document.getElementById('nextPage');
            
            if (prevPage) {
                prevPage.addEventListener('click', () => {
                    if (currentPage > 1) {
                        applyFiltersAndRender(currentPage - 1);
                    }
                });
            }
            
            if (nextPage) {
                nextPage.addEventListener('click', () => {
                    if (currentPage < totalPages) {
                        applyFiltersAndRender(currentPage + 1);
                    }
                });
            }
            
            // Load initial blogs when Edit/Delete section is shown
            const originalShowContentSection = showContentSection;
            showContentSection = function(tabTitle) {
                // Reset to add mode when switching away from Add Blogs tab
                if (tabTitle !== 'Add Blogs' && currentEditingBlog) {
                    switchToAddMode();
                }
                
                originalShowContentSection(tabTitle);
                
                if (tabTitle === 'Edit/Delete Blog') {
                    // Load blogs when the section is first shown
                    setTimeout(() => {
                        fetchBlogs();
                    }, 100);
                }
            };
            
            const navbarTabs = [
                { title: "Homepage", icon: "home" },
                { title: "Add Blogs", icon: "plus-circle" },
                { title: "Edit/Delete Blog", icon: "edit" },
                // { title: "Manage Images", icon: "image" }
            ];
            const navbarContainer = document.getElementById('navbarTabs');
            const expandableTabs = new ExpandableTabs(navbarContainer, {
                tabs: navbarTabs,
                activeColor: 'text-blue-400',
                onChange: (index) => {
                    console.log('Navbar tab changed:', index);
                    if (index !== null && navbarTabs[index]) {
                        console.log('Selected tab:', navbarTabs[index].title);
                        if (navbarTabs[index].title === "Homepage") {
                            window.location.href = '/admin_login';
                        } else if (navbarTabs[index].title === "Add Blogs") {
                            // Clear and refresh the form when Add Blogs is clicked
                            if (!isEditing) {
                                switchToAddMode();
                            }
                            showContentSection(navbarTabs[index].title);
                        } else {
                            showContentSection(navbarTabs[index].title);
                        }
                    }
                }
            });
            expandableTabs.selected = 1;
            expandableTabs.render();
            
            // Left sidebar tab functionality
            const leftTabButtons = document.querySelectorAll('.left-tab-button');
            const leftContentSections = document.querySelectorAll('.left-content-section');
            
            leftTabButtons.forEach(button => {
                button.addEventListener('click', function() {
                    const tabName = this.getAttribute('data-left-tab');
                    
                    // Remove active class from all buttons
                    leftTabButtons.forEach(btn => btn.classList.remove('active'));
                    // Add active class to clicked button
                    this.classList.add('active');
                    
                    // Hide all content sections
                    leftContentSections.forEach(section => section.classList.remove('active'));
                    // Show corresponding content section
                    const targetSection = document.getElementById(tabName + 'Content');
                    if (targetSection) {
                        targetSection.classList.add('active');
                    }
                    
                    // Load content when needed
                    if (tabName === 'storage') {
                        setTimeout(() => {
                            loadGallery();
                            loadMagazines();
                        }, 100);
                    }
                });
            });
            
            // Storage sub-tabs functionality
            const storageSubTabs = document.querySelectorAll('.storage-sub-tab');
            const storageSubContents = document.querySelectorAll('.storage-sub-content');
            
            storageSubTabs.forEach(tab => {
                tab.addEventListener('click', function() {
                    const subTabName = this.getAttribute('data-storage-tab');
                    
                    // Remove active class from all sub-tabs
                    storageSubTabs.forEach(subTab => {
                        subTab.classList.remove('active');
                        subTab.style.background = 'rgba(255, 255, 255, 0.05)';
                        subTab.style.color = 'rgba(255, 255, 255, 0.6)';
                        subTab.style.borderColor = 'rgba(255, 255, 255, 0.1)';
                    });
                    
                    // Add active class to clicked sub-tab
                    this.classList.add('active');
                    this.style.background = 'rgba(59, 130, 246, 0.2)';
                    this.style.color = 'white';
                    this.style.borderColor = 'rgba(59, 130, 246, 0.4)';
                    
                    // Hide all sub-content sections
                    storageSubContents.forEach(content => content.classList.remove('active'));
                    
                    // Show corresponding sub-content
                    const targetSubContent = document.getElementById(subTabName + 'SubContent');
                    if (targetSubContent) {
                        targetSubContent.classList.add('active');
                    }
                    
                    // Load content when needed
                    if (subTabName === 'gallery') {
                        setTimeout(() => loadGallery(), 100);
                    } else if (subTabName === 'magazines') {
                        setTimeout(() => loadMagazines(), 100);
                    }
                });
            });
            
            // Upload and gallery functionality
            let imageFilesToUpload = [];
            let magazineFilesToUpload = [];
            let imageFiles = [];
            let magazineFiles = [];
            
            // Initialize image upload functionality
            const imageDropzone = document.getElementById('imageDropzone');
            const imageFileInput = document.getElementById('imageFileInput');
            const imageFileQueue = document.getElementById('imageFileQueue');
            const imageUploadBtn = document.getElementById('imageUploadBtn');
            const imageUploadBtnText = document.getElementById('imageUploadBtnText');
            
            // Initialize magazine upload functionality
            const magazineDropzone = document.getElementById('magazineDropzone');
            const magazineFileInput = document.getElementById('magazineFileInput');
            const magazineFileQueue = document.getElementById('magazineFileQueue');
            const magazineUploadBtn = document.getElementById('magazineUploadBtn');
            const magazineUploadBtnText = document.getElementById('magazineUploadBtnText');
            
            // Image upload functionality
            if (imageDropzone && imageFileInput) {
                setupFileUpload(
                    imageDropzone, imageFileInput, imageFileQueue, imageUploadBtn, imageUploadBtnText,
                    imageFilesToUpload, 'image', 'images'
                );
            }
            
            // Magazine upload functionality
            if (magazineDropzone && magazineFileInput) {
                setupFileUpload(
                    magazineDropzone, magazineFileInput, magazineFileQueue, magazineUploadBtn, magazineUploadBtnText,
                    magazineFilesToUpload, 'pdf', 'magazines'
                );
            }
            
            function setupFileUpload(dropzone, fileInput, fileQueue, uploadBtn, uploadBtnText, filesToUpload, fileType, displayType) {
                // Drag and drop functionality
                ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
                    dropzone.addEventListener(eventName, e => { e.preventDefault(); e.stopPropagation(); });
                });
                
                ['dragenter', 'dragover'].forEach(eventName => {
                    dropzone.addEventListener(eventName, () => dropzone.classList.add('dragover'));
                });
                
                ['dragleave', 'drop'].forEach(eventName => {
                    dropzone.addEventListener(eventName, () => dropzone.classList.remove('dragover'));
                });
                
                dropzone.addEventListener('drop', (e) => handleFiles(e.dataTransfer.files, fileType, filesToUpload, fileQueue, uploadBtn, uploadBtnText));
                fileInput.addEventListener('change', (e) => handleFiles(e.target.files, fileType, filesToUpload, fileQueue, uploadBtn, uploadBtnText));
                
                uploadBtn.addEventListener('click', async () => {
                    if (filesToUpload.length === 0) {
                        showToast(`No ${displayType} selected for upload`, 'error');
                        return;
                    }
                    
                    uploadBtn.disabled = true;
                    uploadBtnText.textContent = 'Uploading...';
                    
                    let successCount = 0;
                    let errorCount = 0;
                    let errorMessages = [];
                    
                    for (let i = 0; i < filesToUpload.length; i++) {
                        const file = filesToUpload[i];
                        try {
                            const formData = new FormData();
                            formData.append('file', file);
                            
                            const response = await fetch('/upload_file', {
                                method: 'POST',
                                body: formData
                            });
                            
                            const result = await response.json();
                            
                            if (response.ok && result.status === 'success') {
                                successCount++;
                            } else {
                                errorCount++;
                                errorMessages.push(result.message || `Failed to upload ${file.name}`);
                                console.error(`Failed to upload ${file.name}:`, result.message);
                            }
                        } catch (error) {
                            errorCount++;
                            errorMessages.push(`Network error uploading ${file.name}`);
                            console.error(`Network error uploading ${file.name}:`, error);
                        }
                        
                        uploadBtnText.textContent = `Uploading... (${i + 1}/${filesToUpload.length})`;
                    }
                    
                    if (successCount > 0 && errorCount === 0) {
                        showToast(`Successfully uploaded ${successCount} ${displayType.slice(0, -1)}${successCount !== 1 ? 's' : ''}!`, 'success');
                    } else if (successCount > 0 && errorCount > 0) {
                        showToast(`Uploaded ${successCount} ${displayType} successfully, but ${errorCount} failed: ${errorMessages.join(', ')}`, 'warning');
                    } else {
                        showToast(`All uploads failed: ${errorMessages.join(', ')}`, 'error');
                    }
                    
                    if (successCount > 0) {
                        if (fileType === 'image') {
                            await loadGallery();
                        } else if (fileType === 'pdf') {
                            await loadMagazines();
                        }
                    }
                    
                    filesToUpload.length = 0;
                    updateFileQueueUI(filesToUpload, fileQueue, uploadBtn, uploadBtnText);
                });
                
                fileQueue.addEventListener('click', (e) => {
                    const removeBtn = e.target.closest('.remove-file-btn');
                    if (removeBtn) {
                        filesToUpload.splice(parseInt(removeBtn.dataset.index), 1);
                        updateFileQueueUI(filesToUpload, fileQueue, uploadBtn, uploadBtnText);
                    }
                });
            }
            
            function handleFiles(files, fileType, filesToUpload, fileQueue, uploadBtn, uploadBtnText) {
                const validFiles = [];
                const invalidFiles = [];
                
                Array.from(files).forEach(file => {
                    if (fileType === 'image') {
                        if (file.type.startsWith('image/') &&
                            ['image/jpeg', 'image/jpg', 'image/png', 'image/gif', 'image/webp', 'image/bmp', 'image/svg+xml'].includes(file.type.toLowerCase())) {
                            validFiles.push(file);
                        } else {
                            invalidFiles.push(file);
                        }
                    } else if (fileType === 'pdf') {
                        // More strict PDF validation - must have .pdf extension AND proper MIME type
                        if (file.name.toLowerCase().endsWith('.pdf') &&
                            (file.type === 'application/pdf' || file.type === '')) {
                            validFiles.push(file);
                        } else {
                            invalidFiles.push(file);
                        }
                    }
                });
                
                if (invalidFiles.length > 0) {
                    const fileNames = invalidFiles.map(f => f.name).join(', ');
                    const expectedTypes = fileType === 'image' ? 'PNG, JPG, JPEG, GIF, WEBP, BMP, SVG' : 'PDF';
                    showToast(`Invalid file type(s): ${fileNames}. Expected: ${expectedTypes}`, 'error');
                }
                
                if (validFiles.length > 0) {
                    filesToUpload.push(...validFiles);
                    updateFileQueueUI(filesToUpload, fileQueue, uploadBtn, uploadBtnText);
                }
            }
            
            function updateFileQueueUI(filesToUpload, fileQueue, uploadBtn, uploadBtnText) {
                fileQueue.innerHTML = '';
                if (filesToUpload.length > 0) {
                    filesToUpload.forEach((file, index) => {
                        const fileItem = document.createElement('div');
                        fileItem.className = 'file-queue-item';
                        const iconName = file.type.startsWith('image/') ? 'image' : 'file-text';
                        fileItem.innerHTML = `
                            <div class="flex-shrink-0 mr-3">
                                <i data-lucide="${iconName}" class="w-5 h-5 text-white/70"></i>
                            </div>
                            <div class="flex-1 min-w-0">
                                <p class="text-sm font-medium truncate">${file.name}</p>
                                <p class="text-xs text-white/50">${(file.size / 1024 / 1024).toFixed(2)} MB</p>
                            </div>
                            <button data-index="${index}" class="remove-file-btn ml-4 text-white/50 hover:text-red-500 transition-colors p-1">
                                <i data-lucide="x" class="w-5 h-5"></i>
                            </button>
                        `;
                        fileQueue.appendChild(fileItem);
                    });
                    lucide.createIcons();
                }
                uploadBtn.disabled = filesToUpload.length === 0;
                uploadBtnText.textContent = `Upload ${filesToUpload.length} File${filesToUpload.length !== 1 ? 's' : ''}`;
            }
            
            // Gallery functionality
            async function loadGallery() {
                try {
                    const response = await fetch('/get_file_details?bucket_name=blog-images');
                    const result = await response.json();
                    
                    if (result.status === 'success' && result.data) {
                        imageFiles = result.data.map(file => ({
                            id: file.id,
                            name: file.name,
                            url: file.public_url,
                            size: file.size
                        }));
                        renderGallery();
                    }
                } catch (error) {
                    console.error('Error loading gallery:', error);
                }
            }
            
            async function loadMagazines() {
                try {
                    const response = await fetch('/get_file_details?bucket_name=magazine-pdfs');
                    const result = await response.json();
                    
                    if (result.status === 'success' && result.data) {
                        // Filter only PDF files
                        magazineFiles = result.data
                            .filter(file => file.name.toLowerCase().endsWith('.pdf'))
                            .map(file => ({
                                id: file.id,
                                name: file.name,
                                url: file.public_url,
                                size: file.size
                            }));
                        renderMagazines();
                    }
                } catch (error) {
                    console.error('Error loading magazines:', error);
                }
            }
            
            function renderGallery(searchTerm = '') {
                const galleryGrid = document.getElementById('galleryGrid');
                const noItemsDiv = document.getElementById('noGalleryItems');
                
                if (!galleryGrid) return;
                
                let filteredImages = imageFiles;
                if (searchTerm) {
                    filteredImages = imageFiles.filter(item =>
                        item.name.toLowerCase().includes(searchTerm.toLowerCase())
                    );
                }
                
                galleryGrid.innerHTML = '';
                
                if (filteredImages.length === 0) {
                    noItemsDiv.classList.remove('hidden');
                } else {
                    noItemsDiv.classList.add('hidden');
                    filteredImages.forEach(item => {
                        const itemEl = document.createElement('div');
                        itemEl.className = 'gallery-item group aspect-square';
                        itemEl.innerHTML = `
                            <img src="${item.url}" alt="${item.name}" class="absolute inset-0 w-full h-full object-cover" loading="lazy">
                            <div class="overlay"></div>
                            <div class="relative z-10 text-white p-2 flex flex-col justify-end h-full opacity-0 group-hover:opacity-100 transition-opacity duration-300">
                                <p class="text-xs font-semibold truncate">${item.name}</p>
                            </div>
                            <div class="actions">
                                <button class="action-btn" data-action="copy" data-url="${item.url}" title="Copy URL">
                                    <i data-lucide="link" class="w-3 h-3 text-white"></i>
                                </button>
                                <button class="action-btn" data-action="view" data-url="${item.url}" title="View">
                                    <i data-lucide="external-link" class="w-3 h-3 text-white"></i>
                                </button>
                                <button class="action-btn delete" data-action="delete" data-id="${item.id}" data-name="${item.name}" title="Delete">
                                    <i data-lucide="trash-2" class="w-3 h-3 text-white"></i>
                                </button>
                            </div>
                        `;
                        galleryGrid.appendChild(itemEl);
                    });
                }
                lucide.createIcons();
            }
            
            function renderMagazines(searchTerm = '') {
                const magazinesGrid = document.getElementById('magazinesGrid');
                const noItemsDiv = document.getElementById('noMagazineItems');
                
                if (!magazinesGrid) return;
                
                let filteredMagazines = magazineFiles;
                if (searchTerm) {
                    filteredMagazines = magazineFiles.filter(item =>
                        item.name.toLowerCase().includes(searchTerm.toLowerCase())
                    );
                }
                
                magazinesGrid.innerHTML = '';
                
                if (filteredMagazines.length === 0) {
                    noItemsDiv.classList.remove('hidden');
                } else {
                    noItemsDiv.classList.add('hidden');
                    filteredMagazines.forEach(item => {
                        const itemEl = document.createElement('div');
                        itemEl.className = 'gallery-item group aspect-[3/4]';
                        itemEl.innerHTML = `
                            <div class="absolute inset-0 w-full h-full bg-white/5 border border-white/20 rounded-lg flex flex-col items-center justify-center">
                                <i data-lucide="file-text" class="w-12 h-12 text-white/60 mb-2"></i>
                                <p class="text-xs text-white/80 text-center px-2">${item.name}</p>
                                <p class="text-xs text-white/50 mt-1">${item.size}</p>
                            </div>
                            <div class="overlay"></div>
                            <div class="actions">
                                <button class="action-btn" data-action="copy" data-url="${item.url}" title="Copy URL">
                                    <i data-lucide="link" class="w-3 h-3 text-white"></i>
                                </button>
                                <button class="action-btn" data-action="view" data-url="${item.url}" title="View">
                                    <i data-lucide="external-link" class="w-3 h-3 text-white"></i>
                                </button>
                                <button class="action-btn delete" data-action="delete" data-id="${item.id}" data-name="${item.name}" title="Delete">
                                    <i data-lucide="trash-2" class="w-3 h-3 text-white"></i>
                                </button>
                            </div>
                        `;
                        magazinesGrid.appendChild(itemEl);
                    });
                }
                lucide.createIcons();
            }
            
            // Gallery actions
            const galleryGrid = document.getElementById('galleryGrid');
            const magazinesGrid = document.getElementById('magazinesGrid');
            
            if (galleryGrid) {
                galleryGrid.addEventListener('click', (e) => {
                    const actionBtn = e.target.closest('.action-btn');
                    if (!actionBtn) return;
                    
                    const action = actionBtn.dataset.action;
                    const itemUrl = actionBtn.dataset.url;
                    const itemId = actionBtn.dataset.id;
                    const itemName = actionBtn.dataset.name;
                    
                    if (action === 'copy') {
                        if (navigator.clipboard && window.isSecureContext) {
                            navigator.clipboard.writeText(itemUrl).then(() => {
                                showToast('URL copied to clipboard!', 'success');
                            }).catch(() => {
                                fallbackCopyTextToClipboard(itemUrl);
                            });
                        } else {
                            fallbackCopyTextToClipboard(itemUrl);
                        }
                    } else if (action === 'view') {
                        window.open(itemUrl, '_blank');
                    } else if (action === 'delete') {
                        handleGalleryDelete(itemId, itemName, 'image');
                    }
                });
            }
            
            if (magazinesGrid) {
                magazinesGrid.addEventListener('click', (e) => {
                    const actionBtn = e.target.closest('.action-btn');
                    if (!actionBtn) return;
                    
                    const action = actionBtn.dataset.action;
                    const itemUrl = actionBtn.dataset.url;
                    const itemId = actionBtn.dataset.id;
                    const itemName = actionBtn.dataset.name;
                    
                    if (action === 'copy') {
                        if (navigator.clipboard && window.isSecureContext) {
                            navigator.clipboard.writeText(itemUrl).then(() => {
                                showToast('URL copied to clipboard!', 'success');
                            }).catch(() => {
                                fallbackCopyTextToClipboard(itemUrl);
                            });
                        } else {
                            fallbackCopyTextToClipboard(itemUrl);
                        }
                    } else if (action === 'view') {
                        window.open(itemUrl, '_blank');
                    } else if (action === 'delete') {
                        handleGalleryDelete(itemId, itemName, 'magazine');
                    }
                });
            }
            
            // Search functionality
            const gallerySearchInput = document.getElementById('gallerySearchInput');
            const magazinesSearchInput = document.getElementById('magazinesSearchInput');
            
            if (gallerySearchInput) {
                const gallerySearchContainer = gallerySearchInput.parentElement;
                
                gallerySearchInput.addEventListener('focus', () => {
                    gallerySearchContainer.classList.add('focused');
                });
                
                gallerySearchInput.addEventListener('blur', () => {
                    gallerySearchContainer.classList.remove('focused');
                });
                
                gallerySearchInput.addEventListener('input', (e) => {
                    const searchTerm = e.target.value.trim();
                    renderGallery(searchTerm);
                });
            }
            
            if (magazinesSearchInput) {
                const magazinesSearchContainer = magazinesSearchInput.parentElement;
                
                magazinesSearchInput.addEventListener('focus', () => {
                    magazinesSearchContainer.classList.add('focused');
                });
                
                magazinesSearchInput.addEventListener('blur', () => {
                    magazinesSearchContainer.classList.remove('focused');
                });
                
                magazinesSearchInput.addEventListener('input', (e) => {
                    const searchTerm = e.target.value.trim();
                    renderMagazines(searchTerm);
                });
            }
            
            function fallbackCopyTextToClipboard(text) {
                const textArea = document.createElement("textarea");
                textArea.value = text;
                textArea.style.position = "fixed";
                textArea.style.top = "0";
                textArea.style.left = "0";
                document.body.appendChild(textArea);
                textArea.focus();
                textArea.select();
                try {
                    document.execCommand('copy');
                    showToast('URL copied to clipboard!', 'success');
                } catch (err) {
                    console.error('Failed to copy', err);
                    showToast('Failed to copy URL', 'error');
                }
                document.body.removeChild(textArea);
            }
            
            // Toast notification function
            function showToast(message, type = 'success') {
                const toast = document.createElement('div');
                let bgColor = 'bg-green-600';
                if (type === 'error') {
                    bgColor = 'bg-red-600';
                } else if (type === 'warning') {
                    bgColor = 'bg-yellow-600';
                }
                toast.className = `fixed top-4 right-4 ${bgColor} text-white px-4 py-2 rounded-lg shadow-lg z-50 transition-all duration-300`;
                toast.textContent = message;
                document.body.appendChild(toast);
                setTimeout(() => {
                    toast.style.opacity = '0';
                    toast.style.transform = 'translateY(-20px)';
                    setTimeout(() => {
                        if (toast.parentElement) {
                            document.body.removeChild(toast);
                        }
                    }, 300);
                }, 3000);
            }
            
            // Delete function for gallery and magazines
            async function handleGalleryDelete(itemId, itemName, type) {
                if (!itemName) {
                    console.error('No file name provided to handleGalleryDelete');
                    showToast('Error: File name is missing', 'error');
                    return;
                }
                
                const displayType = type === 'image' ? 'image' : 'magazine';
                
                if (confirm(`Are you sure you want to delete "${itemName}"? This action cannot be undone.`)) {
                    showToast('Deleting file...', 'success');
                    
                    try {
                        const response = await fetch('/delete_file', {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json',
                            },
                            body: JSON.stringify({
                                file_name: itemName
                            })
                        });
                        
                        const result = await response.json();
                        
                        if (response.ok && result.status === 'success') {
                            if (type === 'image') {
                                const itemIndex = imageFiles.findIndex(item => item.id == itemId);
                                if (itemIndex > -1) {
                                    imageFiles.splice(itemIndex, 1);
                                    renderGallery();
                                } else {
                                    await loadGallery();
                                }
                            } else {
                                const itemIndex = magazineFiles.findIndex(item => item.id == itemId);
                                if (itemIndex > -1) {
                                    magazineFiles.splice(itemIndex, 1);
                                    renderMagazines();
                                } else {
                                    await loadMagazines();
                                }
                            }
                            showToast(`${displayType.charAt(0).toUpperCase() + displayType.slice(1)} "${itemName}" deleted successfully!`, 'success');
                        } else {
                            console.error('Delete failed:', result.message);
                            showToast(`Failed to delete ${displayType}: ${result.message || 'Unknown error'}`, 'error');
                        }
                    } catch (error) {
                        console.error('Error deleting file:', error);
                        showToast(`Error deleting ${displayType}: ${error.message}`, 'error');
                    }
                }
            }
            
            setTimeout(() => {
                lucide.createIcons();
            }, 100);
        });
    </script>
</body>
</html>